{"ast":null,"code":"import _classCallCheck from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{Icon,Progress,Label,Popup}from'semantic-ui-react';import{Slider}from'react-semantic-ui-range';import{formatTimestamp}from'../../utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var Controls=/*#__PURE__*/function(_React$Component){_inherits(Controls,_React$Component);var _super=_createSuper(Controls);function Controls(){var _this;_classCallCheck(this,Controls);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={showTimestamp:false,currTimestamp:0,posTimestamp:0,volume:1,muted:_this.props.muted};_this.onMouseOver=function(){// console.log('mouseover');\n_this.setState({showTimestamp:true});};_this.onMouseOut=function(){// console.log('mouseout');\n_this.setState({showTimestamp:false});};_this.onMouseMove=function(e){var rect=e.target.getBoundingClientRect();var x=e.clientX-rect.left;var max=rect.width;var pct=x/max;// console.log(x, max);\nvar target=pct*_this.props.duration;// console.log(pct);\nif(pct>=0){_this.setState({currTimestamp:target,posTimestamp:pct});}};return _this;}_createClass(Controls,[{key:\"render\",value:function render(){var _this2=this;var _this$props=this.props,togglePlay=_this$props.togglePlay,onSeek=_this$props.onSeek,fullScreen=_this$props.fullScreen,toggleMute=_this$props.toggleMute,toggleSubtitle=_this$props.toggleSubtitle,jumpToLeader=_this$props.jumpToLeader,currentTime=_this$props.currentTime,duration=_this$props.duration,leaderTime=_this$props.leaderTime,isPauseDisabled=_this$props.isPauseDisabled,disabled=_this$props.disabled,subtitled=_this$props.subtitled,paused=_this$props.paused;var _this$state=this.state,muted=_this$state.muted,volume=_this$state.volume;var isBehind=leaderTime&&leaderTime-currentTime>5;return/*#__PURE__*/_jsxs(\"div\",{className:\"controls\",children:[/*#__PURE__*/_jsx(Icon,{size:\"large\",onClick:function onClick(){togglePlay();},className:\"control action\",disabled:disabled||isPauseDisabled,name:paused?'play':'pause'}),/*#__PURE__*/_jsx(Popup,{content:(isBehind?\"We've detected that your stream is behind. \":'')+'Click to sync to leader.',trigger:/*#__PURE__*/_jsx(Icon,{size:\"large\",onClick:jumpToLeader,className:\"control action \".concat(isBehind?'glowing':''),name:'angle double right'})}),/*#__PURE__*/_jsx(\"div\",{className:\"control\",children:formatTimestamp(currentTime)}),/*#__PURE__*/_jsx(Progress,{size:\"tiny\",color:\"blue\",onClick:duration<Infinity&&!this.props.disabled?onSeek:undefined,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,onMouseMove:this.onMouseMove,className:\"control action\",inverted:true,style:{flexGrow:1,marginTop:0,marginBottom:0,position:'relative',minWidth:'50px'},value:currentTime,total:duration,children:duration<Infinity&&this.state.showTimestamp&&/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',bottom:'0px',left:\"calc(\".concat(this.state.posTimestamp*100+'% - 27px',\")\"),pointerEvents:'none'},children:/*#__PURE__*/_jsx(Label,{basic:true,color:\"blue\",pointing:\"below\",children:/*#__PURE__*/_jsx(\"div\",{style:{width:'34px'},children:formatTimestamp(this.state.currTimestamp)})})})}),/*#__PURE__*/_jsx(\"div\",{className:\"control\",children:formatTimestamp(duration)}),/*#__PURE__*/_jsx(Icon,{size:\"large\",onClick:function onClick(){toggleSubtitle();},className:\"control action\",name:subtitled?'closed captioning':'closed captioning outline',title:\"Captions\"}),/*#__PURE__*/_jsx(Icon,{size:\"large\",onClick:function onClick(){return fullScreen(false);},className:\"control action\",style:{transform:'rotate(90deg)'},name:\"window maximize outline\",title:\"Theater Mode\"}),/*#__PURE__*/_jsx(Icon,{size:\"large\",onClick:function onClick(){return fullScreen(true);},className:\"control action\",name:\"expand\",title:\"Fullscreen\"}),/*#__PURE__*/_jsx(Icon,{size:\"large\",onClick:function onClick(){toggleMute();_this2.setState({muted:!_this2.state.muted});},className:\"control action\",name:muted?'volume off':'volume up',title:\"Mute\"}),/*#__PURE__*/_jsx(\"div\",{style:{width:'100px',marginRight:'10px'},children:/*#__PURE__*/_jsx(Slider,{value:volume,color:\"blue\",settings:{min:0,max:1,step:0.01,onChange:function onChange(value){_this2.setState({volume:value});_this2.props.setVolume(value);}}})})]});}}]);return Controls;}(React.Component);","map":{"version":3,"sources":["/home/runner/work/watchparty/watchparty/src/components/Controls/Controls.tsx"],"names":["React","Icon","Progress","Label","Popup","Slider","formatTimestamp","Controls","state","showTimestamp","currTimestamp","posTimestamp","volume","muted","props","onMouseOver","setState","onMouseOut","onMouseMove","e","rect","target","getBoundingClientRect","x","clientX","left","max","width","pct","duration","togglePlay","onSeek","fullScreen","toggleMute","toggleSubtitle","jumpToLeader","currentTime","leaderTime","isPauseDisabled","disabled","subtitled","paused","isBehind","Infinity","undefined","flexGrow","marginTop","marginBottom","position","minWidth","bottom","pointerEvents","transform","marginRight","min","step","onChange","value","setVolume","Component"],"mappings":"wmBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,IAAT,CAAeC,QAAf,CAAyBC,KAAzB,CAAgCC,KAAhC,KAA6C,mBAA7C,CACA,OAASC,MAAT,KAAuB,yBAAvB,CACA,OAASC,eAAT,KAAgC,aAAhC,C,wFAoBA,UAAaC,CAAAA,QAAb,+UACEC,KADF,CACU,CACNC,aAAa,CAAE,KADT,CAENC,aAAa,CAAE,CAFT,CAGNC,YAAY,CAAE,CAHR,CAINC,MAAM,CAAE,CAJF,CAKNC,KAAK,CAAE,MAAKC,KAAL,CAAWD,KALZ,CADV,OASEE,WATF,CASgB,UAAM,CAClB;AACA,MAAKC,QAAL,CAAc,CAAEP,aAAa,CAAE,IAAjB,CAAd,EACD,CAZH,OAcEQ,UAdF,CAce,UAAM,CACjB;AACA,MAAKD,QAAL,CAAc,CAAEP,aAAa,CAAE,KAAjB,CAAd,EACD,CAjBH,OAmBES,WAnBF,CAmBgB,SAACC,CAAD,CAAY,CACxB,GAAMC,CAAAA,IAAI,CAAGD,CAAC,CAACE,MAAF,CAASC,qBAAT,EAAb,CACA,GAAMC,CAAAA,CAAC,CAAGJ,CAAC,CAACK,OAAF,CAAYJ,IAAI,CAACK,IAA3B,CACA,GAAMC,CAAAA,GAAG,CAAGN,IAAI,CAACO,KAAjB,CACA,GAAMC,CAAAA,GAAG,CAAGL,CAAC,CAAGG,GAAhB,CACA;AACA,GAAML,CAAAA,MAAM,CAAGO,GAAG,CAAG,MAAKd,KAAL,CAAWe,QAAhC,CACA;AACA,GAAID,GAAG,EAAI,CAAX,CAAc,CACZ,MAAKZ,QAAL,CAAc,CAAEN,aAAa,CAAEW,MAAjB,CAAyBV,YAAY,CAAEiB,GAAvC,CAAd,EACD,CACF,CA9BH,0DAgCE,iBAAS,iBACP,gBAcI,KAAKd,KAdT,CACEgB,UADF,aACEA,UADF,CAEEC,MAFF,aAEEA,MAFF,CAGEC,UAHF,aAGEA,UAHF,CAIEC,UAJF,aAIEA,UAJF,CAKEC,cALF,aAKEA,cALF,CAMEC,YANF,aAMEA,YANF,CAOEC,WAPF,aAOEA,WAPF,CAQEP,QARF,aAQEA,QARF,CASEQ,UATF,aASEA,UATF,CAUEC,eAVF,aAUEA,eAVF,CAWEC,QAXF,aAWEA,QAXF,CAYEC,SAZF,aAYEA,SAZF,CAaEC,MAbF,aAaEA,MAbF,CAeA,gBAA0B,KAAKjC,KAA/B,CAAQK,KAAR,aAAQA,KAAR,CAAeD,MAAf,aAAeA,MAAf,CACA,GAAM8B,CAAAA,QAAQ,CAAGL,UAAU,EAAIA,UAAU,CAAGD,WAAb,CAA2B,CAA1D,CACA,mBACE,aAAK,SAAS,CAAC,UAAf,wBACE,KAAC,IAAD,EACE,IAAI,CAAC,OADP,CAEE,OAAO,CAAE,kBAAM,CACbN,UAAU,GACX,CAJH,CAKE,SAAS,CAAC,gBALZ,CAME,QAAQ,CAAES,QAAQ,EAAID,eANxB,CAOE,IAAI,CAAEG,MAAM,CAAG,MAAH,CAAY,OAP1B,EADF,cAUE,KAAC,KAAD,EACE,OAAO,CACL,CAACC,QAAQ,CAAG,6CAAH,CAAmD,EAA5D,EACA,0BAHJ,CAKE,OAAO,cACL,KAAC,IAAD,EACE,IAAI,CAAC,OADP,CAEE,OAAO,CAAEP,YAFX,CAGE,SAAS,0BAAoBO,QAAQ,CAAG,SAAH,CAAe,EAA3C,CAHX,CAIE,IAAI,CAAE,oBAJR,EANJ,EAVF,cAwBE,YAAK,SAAS,CAAC,SAAf,UAA0BpC,eAAe,CAAC8B,WAAD,CAAzC,EAxBF,cAyBE,KAAC,QAAD,EACE,IAAI,CAAC,MADP,CAEE,KAAK,CAAC,MAFR,CAGE,OAAO,CACLP,QAAQ,CAAGc,QAAX,EAAuB,CAAC,KAAK7B,KAAL,CAAWyB,QAAnC,CAA8CR,MAA9C,CAAuDa,SAJ3D,CAME,WAAW,CAAE,KAAK7B,WANpB,CAOE,UAAU,CAAE,KAAKE,UAPnB,CAQE,WAAW,CAAE,KAAKC,WARpB,CASE,SAAS,CAAC,gBATZ,CAUE,QAAQ,KAVV,CAWE,KAAK,CAAE,CACL2B,QAAQ,CAAE,CADL,CAELC,SAAS,CAAE,CAFN,CAGLC,YAAY,CAAE,CAHT,CAILC,QAAQ,CAAE,UAJL,CAKLC,QAAQ,CAAE,MALL,CAXT,CAkBE,KAAK,CAAEb,WAlBT,CAmBE,KAAK,CAAEP,QAnBT,UAqBGA,QAAQ,CAAGc,QAAX,EAAuB,KAAKnC,KAAL,CAAWC,aAAlC,eACC,YACE,KAAK,CAAE,CACLuC,QAAQ,CAAE,UADL,CAELE,MAAM,CAAE,KAFH,CAGLzB,IAAI,gBAAU,KAAKjB,KAAL,CAAWG,YAAX,CAA0B,GAA1B,CAAgC,UAA1C,KAHC,CAILwC,aAAa,CAAE,MAJV,CADT,uBAQE,KAAC,KAAD,EAAO,KAAK,KAAZ,CAAa,KAAK,CAAC,MAAnB,CAA0B,QAAQ,CAAC,OAAnC,uBACE,YAAK,KAAK,CAAE,CAAExB,KAAK,CAAE,MAAT,CAAZ,UACGrB,eAAe,CAAC,KAAKE,KAAL,CAAWE,aAAZ,CADlB,EADF,EARF,EAtBJ,EAzBF,cA+DE,YAAK,SAAS,CAAC,SAAf,UAA0BJ,eAAe,CAACuB,QAAD,CAAzC,EA/DF,cAgEE,KAAC,IAAD,EACE,IAAI,CAAC,OADP,CAEE,OAAO,CAAE,kBAAM,CACbK,cAAc,GACf,CAJH,CAKE,SAAS,CAAC,gBALZ,CAME,IAAI,CAAEM,SAAS,CAAG,mBAAH,CAAyB,2BAN1C,CAOE,KAAK,CAAC,UAPR,EAhEF,cAyEE,KAAC,IAAD,EACE,IAAI,CAAC,OADP,CAEE,OAAO,CAAE,yBAAMR,CAAAA,UAAU,CAAC,KAAD,CAAhB,EAFX,CAGE,SAAS,CAAC,gBAHZ,CAIE,KAAK,CAAE,CAAEoB,SAAS,CAAE,eAAb,CAJT,CAKE,IAAI,CAAC,yBALP,CAME,KAAK,CAAC,cANR,EAzEF,cAiFE,KAAC,IAAD,EACE,IAAI,CAAC,OADP,CAEE,OAAO,CAAE,yBAAMpB,CAAAA,UAAU,CAAC,IAAD,CAAhB,EAFX,CAGE,SAAS,CAAC,gBAHZ,CAIE,IAAI,CAAC,QAJP,CAKE,KAAK,CAAC,YALR,EAjFF,cAwFE,KAAC,IAAD,EACE,IAAI,CAAC,OADP,CAEE,OAAO,CAAE,kBAAM,CACbC,UAAU,GACV,MAAI,CAACjB,QAAL,CAAc,CAAEH,KAAK,CAAE,CAAC,MAAI,CAACL,KAAL,CAAWK,KAArB,CAAd,EACD,CALH,CAME,SAAS,CAAC,gBANZ,CAOE,IAAI,CAAEA,KAAK,CAAG,YAAH,CAAkB,WAP/B,CAQE,KAAK,CAAC,MARR,EAxFF,cAkGE,YAAK,KAAK,CAAE,CAAEc,KAAK,CAAE,OAAT,CAAkB0B,WAAW,CAAE,MAA/B,CAAZ,uBACE,KAAC,MAAD,EACE,KAAK,CAAEzC,MADT,CAEE,KAAK,CAAC,MAFR,CAGE,QAAQ,CAAE,CACR0C,GAAG,CAAE,CADG,CAER5B,GAAG,CAAE,CAFG,CAGR6B,IAAI,CAAE,IAHE,CAIRC,QAAQ,CAAE,kBAACC,KAAD,CAAmB,CAC3B,MAAI,CAACzC,QAAL,CAAc,CAAEJ,MAAM,CAAE6C,KAAV,CAAd,EACA,MAAI,CAAC3C,KAAL,CAAW4C,SAAX,CAAqBD,KAArB,EACD,CAPO,CAHZ,EADF,EAlGF,GADF,CAoHD,CAtKH,sBAA8BzD,KAAK,CAAC2D,SAApC","sourcesContent":["import React from 'react';\nimport { Icon, Progress, Label, Popup } from 'semantic-ui-react';\nimport { Slider } from 'react-semantic-ui-range';\nimport { formatTimestamp } from '../../utils';\n\ninterface ControlsProps {\n  duration: number;\n  togglePlay: Function;\n  onSeek: Function;\n  fullScreen: Function;\n  toggleMute: Function;\n  toggleSubtitle: Function;\n  jumpToLeader: Function;\n  paused: boolean;\n  muted: boolean;\n  subtitled: boolean;\n  currentTime: number;\n  setVolume: Function;\n  disabled?: boolean;\n  leaderTime?: number;\n  isPauseDisabled?: boolean;\n}\n\nexport class Controls extends React.Component<ControlsProps> {\n  state = {\n    showTimestamp: false,\n    currTimestamp: 0,\n    posTimestamp: 0,\n    volume: 1,\n    muted: this.props.muted,\n  };\n\n  onMouseOver = () => {\n    // console.log('mouseover');\n    this.setState({ showTimestamp: true });\n  };\n\n  onMouseOut = () => {\n    // console.log('mouseout');\n    this.setState({ showTimestamp: false });\n  };\n\n  onMouseMove = (e: any) => {\n    const rect = e.target.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const max = rect.width;\n    const pct = x / max;\n    // console.log(x, max);\n    const target = pct * this.props.duration;\n    // console.log(pct);\n    if (pct >= 0) {\n      this.setState({ currTimestamp: target, posTimestamp: pct });\n    }\n  };\n\n  render() {\n    const {\n      togglePlay,\n      onSeek,\n      fullScreen,\n      toggleMute,\n      toggleSubtitle,\n      jumpToLeader,\n      currentTime,\n      duration,\n      leaderTime,\n      isPauseDisabled,\n      disabled,\n      subtitled,\n      paused,\n    } = this.props;\n    const { muted, volume } = this.state;\n    const isBehind = leaderTime && leaderTime - currentTime > 5;\n    return (\n      <div className=\"controls\">\n        <Icon\n          size=\"large\"\n          onClick={() => {\n            togglePlay();\n          }}\n          className=\"control action\"\n          disabled={disabled || isPauseDisabled}\n          name={paused ? 'play' : 'pause'}\n        />\n        <Popup\n          content={\n            (isBehind ? \"We've detected that your stream is behind. \" : '') +\n            'Click to sync to leader.'\n          }\n          trigger={\n            <Icon\n              size=\"large\"\n              onClick={jumpToLeader}\n              className={`control action ${isBehind ? 'glowing' : ''}`}\n              name={'angle double right'}\n            />\n          }\n        />\n        <div className=\"control\">{formatTimestamp(currentTime)}</div>\n        <Progress\n          size=\"tiny\"\n          color=\"blue\"\n          onClick={\n            duration < Infinity && !this.props.disabled ? onSeek : undefined\n          }\n          onMouseOver={this.onMouseOver}\n          onMouseOut={this.onMouseOut}\n          onMouseMove={this.onMouseMove}\n          className=\"control action\"\n          inverted\n          style={{\n            flexGrow: 1,\n            marginTop: 0,\n            marginBottom: 0,\n            position: 'relative',\n            minWidth: '50px',\n          }}\n          value={currentTime}\n          total={duration}\n        >\n          {duration < Infinity && this.state.showTimestamp && (\n            <div\n              style={{\n                position: 'absolute',\n                bottom: '0px',\n                left: `calc(${this.state.posTimestamp * 100 + '% - 27px'})`,\n                pointerEvents: 'none',\n              }}\n            >\n              <Label basic color=\"blue\" pointing=\"below\">\n                <div style={{ width: '34px' }}>\n                  {formatTimestamp(this.state.currTimestamp)}\n                </div>\n              </Label>\n            </div>\n          )}\n        </Progress>\n        <div className=\"control\">{formatTimestamp(duration)}</div>\n        <Icon\n          size=\"large\"\n          onClick={() => {\n            toggleSubtitle();\n          }}\n          className=\"control action\"\n          name={subtitled ? 'closed captioning' : 'closed captioning outline'}\n          title=\"Captions\"\n        />\n        <Icon\n          size=\"large\"\n          onClick={() => fullScreen(false)}\n          className=\"control action\"\n          style={{ transform: 'rotate(90deg)' }}\n          name=\"window maximize outline\"\n          title=\"Theater Mode\"\n        />\n        <Icon\n          size=\"large\"\n          onClick={() => fullScreen(true)}\n          className=\"control action\"\n          name=\"expand\"\n          title=\"Fullscreen\"\n        />\n        <Icon\n          size=\"large\"\n          onClick={() => {\n            toggleMute();\n            this.setState({ muted: !this.state.muted });\n          }}\n          className=\"control action\"\n          name={muted ? 'volume off' : 'volume up'}\n          title=\"Mute\"\n        />\n        <div style={{ width: '100px', marginRight: '10px' }}>\n          <Slider\n            value={volume}\n            color=\"blue\"\n            settings={{\n              min: 0,\n              max: 1,\n              step: 0.01,\n              onChange: (value: number) => {\n                this.setState({ volume: value });\n                this.props.setVolume(value);\n              },\n            }}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}