(this.webpackJsonpwatchparty=this.webpackJsonpwatchparty||[]).push([[0],{17:function(e,t,n){"use strict";n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return h})),n.d(t,"b",(function(){return p})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return f})),n.d(t,"l",(function(){return j})),n.d(t,"t",(function(){return g})),n.d(t,"d",(function(){return y})),n.d(t,"c",(function(){return w})),n.d(t,"j",(function(){return O})),n.d(t,"q",(function(){return k})),n.d(t,"p",(function(){return S})),n.d(t,"s",(function(){return C})),n.d(t,"k",(function(){return T})),n.d(t,"m",(function(){return P})),n.d(t,"o",(function(){return D})),n.d(t,"r",(function(){return E})),n.d(t,"g",(function(){return _})),n.d(t,"a",(function(){return V})),n.d(t,"n",(function(){return N}));var a=n(2),i=n.n(a),r=n(3),s=n(258),o=n(259),c=n(372),l=n(260),u=n.n(l);function d(e){if(null===e||void 0===e||!1===e||Number.isNaN(e)||e===1/0)return"";var t=Math.floor(Number(e)/3600),n=(Math.floor(Number(e)/60)%60).toString().padStart(2,"0"),a=Math.floor(Number(e)%60).toString().padStart(2,"0");return"".concat(t,":").concat(n,":").concat(a)}function h(e){return e>=1e6?(e/1e6).toFixed(2)+" MiB/s":e>=1e3?(e/1e3).toFixed(0)+" KiB/s":e+" B/s"}var p={red:"B03060",orange:"FE9A76",yellow:"FFD700",olive:"32CD32",green:"016936",teal:"008080",blue:"0E6EB8",violet:"EE82EE",purple:"B413EC",pink:"FF1493",brown:"A52A2A",grey:"A0A0A0",black:"000000"},m={};function b(e){var t=["red","orange","yellow","olive","green","teal","blue","violet","purple","pink","brown","grey"];return m[e]||(m[e]=Math.abs(function(e){for(var t=0,n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}(e))%t.length),t[m[e]]}function f(e){return p[b(e)]}var j=function(e){return e?e.startsWith("https://www.youtube.com/")||e.startsWith("https://youtu.be/")?"youtube":"video":""};function g(){return v.apply(this,arguments)}function v(){return(v=Object(r.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.video();case 2:return t=e.sent,e.abrupt("return",t.result);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent}function w(e,t,n){var a;return function(){var i=this,r=arguments,s=function(){a=null,n||e.apply(i,r)},o=n&&!a;clearTimeout(a),a=setTimeout(s,t),o&&e.apply(i,r)}}var x=function(e){if(e.startsWith("https://gitlab.com/")){var t=e.match(/https:\/\/gitlab.com\/api\/v4\/projects\/(.*)\/repository\/tree/),n=t&&t[1],a=decodeURIComponent(n||"");return"https://glcdn.githack.com/".concat(a,"/-/raw/master/")}return e+"/"},O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"a0a0a0";return"https://ui-avatars.com/api/?name=".concat(e,"&background=").concat(t,"&size=256&color=ffffff")},k=function(){return window.screen.width<=600};var S=function(){return[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:5.161.49.183:3478",username:"username",credential:"password"},{urls:"turn:135.181.147.65:3478",username:"username",credential:"password"},{urls:"turn:numb.viagenie.ca",credential:"watchparty",username:"howardzchung@gmail.com"}]},C=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_STRIPE_PUBLIC_KEY:"pk_live_eVMbIifj5lnvgBleBCRaCv4E00aeXQkPxQ",REACT_APP_RECAPTCHA_SITE_KEY:"6LeDGP4UAAAAAGYZZenyU-3fRdhL3p0BaBmiK9mM",REACT_APP_FIREBASE_CONFIG:'{"apiKey":"AIzaSyA2fkXeFokJ-Ei_jnzDso5AmjbIaMdzuEc","authDomain":"watchparty-273604.firebaseapp.com","databaseURL":"https://watchparty-273604.firebaseio.com","projectId":"watchparty-273604","storageBucket":"watchparty-273604.appspot.com","messagingSenderId":"769614672795","appId":"1:769614672795:web:54bbda86288ab1a034273e"}',REACT_APP_FB_APP_ID:"2.81436471201422E+15"}).REACT_APP_SERVER_HOST||"".concat(window.location.protocol,"//").concat(window.location.host);function T(e,t){return M.apply(this,arguments)}function M(){return(M=Object(r.a)(i.a.mark((function e(t,n){var a,r,s,c,l,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.fetch(t);case 2:if(a=e.sent,r=[],!t.includes("s3.")){e.next=15;break}return e.next=7,a.text();case 7:return s=e.sent,e.next=10,Object(o.parseStringPromise)(s);case 10:c=e.sent,l=c.ListBucketResult.Contents.filter((function(e){return!e.Key[0].includes("/")})),r=l.map((function(e){return{url:t+"/"+e.Key[0],name:t+"/"+e.Key[0]}})),e.next=19;break;case 15:return e.next=17,a.json();case 17:u=e.sent,r=u.filter((function(e){return"file"===e.type})).map((function(e){return{url:e.url||x(t)+e.name,name:x(t)+e.name}}));case 19:return r=r.filter((function(e){return e.name.toLowerCase().includes(n.toLowerCase())})),e.abrupt("return",r);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t){return R.apply(this,arguments)}function R(){return(R=Object(r.a)(i.a.mark((function e(t,n){var a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.fetch(t+"/search?q="+encodeURIComponent(n));case 2:return a=e.sent,e.next=5,a.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return B.apply(this,arguments)}function B(){return(B=Object(r.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.fetch(C+"/youtube?q="+encodeURIComponent(t));case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return I.apply(this,arguments)}function I(){return(I=Object(r.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=document.createElement("input");n.type="file",t&&(n.accept=t),n.addEventListener("change",(function(){e(n.files)})),n.dispatchEvent(new MouseEvent("click"))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){var e=window.localStorage.getItem("watchparty-clientid");return e||(e=Object(c.a)(),window.localStorage.setItem("watchparty-clientid",e)),e}function V(e){return e.length>=1?(e=e.sort((function(e,t){return e-t}))).length%2===0?(e[e.length/2-1]+e[e.length/2])/2:e[(e.length-1)/2]:0}function N(e){return A.apply(this,arguments)}function A(){return(A=Object(r.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.email?u()(t.email):"",!t.email){e.next=8;break}return a="https://www.gravatar.com/avatar/".concat(n,"?d=404&s=256"),e.next=5,window.fetch(a);case 5:if(!e.sent.ok){e.next=8;break}return e.abrupt("return",a);case 8:if(!t.photoURL){e.next=10;break}return e.abrupt("return",t.photoURL+"?height=256&width=256");case 10:return e.abrupt("return","https://www.gravatar.com/avatar/".concat(n,"?d=identicon"));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},290:function(e,t,n){},296:function(e,t,n){},340:function(e,t){},342:function(e,t){},355:function(e,t,n){},370:function(e,t,n){"use strict";n.r(t);var a=n(2),i=n.n(a),r=n(3),s=n(10),o=n(11),c=n(15),l=n(16),u=(n(290),n(291),n(1)),d=n.n(u),h=n(75),p=n.n(h),m=n(138),b=n(32),f=n(22),j=n(23),g=(n(296),n(191)),v=n.n(g),y=n(106),w=n.n(y),x=n(253),O=n.n(x),k=n(414),S=n(395),C=n(84),T=n(403),M=n(147),P=n(406),R=n(221),D=n(409),B=n(401),E=n(402),I=n(412),_=n(398),V=n(410),N=n(273),A=n(257),L=n.n(A),z=n(17);function F(e){return e.charAt(0).toUpperCase()+e.slice(1)}function U(e,t){return Math.floor(Math.random()*(t-e))+e}function Y(){var e=["abandoned","able","absolute","adorable","adventurous","academic","acceptable","acclaimed","accomplished","accurate","aching","acidic","acrobatic","active","actual","adept","admirable","admired","adolescent","adorable","adored","advanced","afraid","affectionate","aged","aggravating","aggressive","agile","agitated","agonizing","agreeable","ajar","alarmed","alarming","alert","alienated","alive","all","altruistic","amazing","ambitious","ample","amused","amusing","anchored","ancient","angelic","angry","anguished","animated","annual","another","antique","anxious","any","apprehensive","appropriate","apt","arctic","arid","aromatic","artistic","ashamed","assured","astonishing","athletic","attached","attentive","attractive","austere","authentic","authorized","automatic","avaricious","average","aware","awesome","awful","awkward","babyish","bad","back","baggy","bare","barren","basic","beautiful","belated","beloved","beneficial","better","best","bewitched","big","big-hearted","biodegradable","bite-sized","bitter","black","black-and-white","bland","blank","blaring","bleak","blind","blissful","blond","blue","blushing","bogus","boiling","bold","bony","boring","bossy","both","bouncy","bountiful","bowed","brave","breakable","brief","bright","brilliant","brisk","broken","bronze","brown","bruised","bubbly","bulky","bumpy","buoyant","burdensome","burly","bustling","busy","buttery","buzzing","calculating","calm","candid","canine","capital","carefree","careful","careless","caring","cautious","cavernous","celebrated","charming","cheap","cheerful","cheery","chief","chilly","chubby","circular","classic","clean","clear","clear-cut","clever","close","closed","cloudy","clueless","clumsy","cluttered","coarse","cold","colorful","colorless","colossal","comfortable","common","compassionate","competent","complete","complex","complicated","composed","concerned","concrete","confused","conscious","considerate","constant","content","conventional","cooked","cool","cooperative","coordinated","corny","corrupt","costly","courageous","courteous","crafty","crazy","creamy","creative","creepy","criminal","crisp","critical","crooked","crowded","cruel","crushing","cuddly","cultivated","cultured","cumbersome","curly","curvy","cute","cylindrical","damaged","damp","dangerous","dapper","daring","darling","dark","dazzling","dead","deadly","deafening","dear","dearest","decent","decimal","decisive","deep","defenseless","defensive","defiant","deficient","definite","definitive","delayed","delectable","delicious","delightful","delirious","demanding","dense","dental","dependable","dependent","descriptive","deserted","detailed","determined","devoted","different","difficult","digital","diligent","dim","dimpled","dimwitted","direct","disastrous","discrete","disfigured","disgusting","disloyal","dismal","distant","downright","dreary","dirty","disguised","dishonest","dismal","distant","distinct","distorted","dizzy","dopey","doting","double","downright","drab","drafty","dramatic","dreary","droopy","dry","dual","dull","dutiful","each","eager","earnest","early","easy","easy-going","ecstatic","edible","educated","elaborate","elastic","elated","elderly","electric","elegant","elementary","elliptical","embarrassed","embellished","eminent","emotional","empty","enchanted","enchanting","energetic","enlightened","enormous","enraged","entire","envious","equal","equatorial","essential","esteemed","ethical","euphoric","even","evergreen","everlasting","every","evil","exalted","excellent","exemplary","exhausted","excitable","excited","exciting","exotic","expensive","experienced","expert","extraneous","extroverted","extra-large","extra-small","fabulous","failing","faint","fair","faithful","fake","false","familiar","famous","fancy","fantastic","far","faraway","far-flung","far-off","fast","fat","fatal","fatherly","favorable","favorite","fearful","fearless","feisty","feline","female","feminine","few","fickle","filthy","fine","finished","firm","first","firsthand","fitting","fixed","flaky","flamboyant","flashy","flat","flawed","flawless","flickering","flimsy","flippant","flowery","fluffy","fluid","flustered","focused","fond","foolhardy","foolish","forceful","forked","formal","forsaken","forthright","fortunate","fragrant","frail","frank","frayed","free","French","fresh","frequent","friendly","frightened","frightening","frigid","frilly","frizzy","frivolous","front","frosty","frozen","frugal","fruitful","full","fumbling","functional","funny","fussy","fuzzy","gargantuan","gaseous","general","generous","gentle","genuine","giant","giddy","gigantic","gifted","giving","glamorous","glaring","glass","gleaming","gleeful","glistening","glittering","gloomy","glorious","glossy","glum","golden","good","good-natured","gorgeous","graceful","gracious","grand","grandiose","granular","grateful","grave","gray","great","greedy","green","gregarious","grim","grimy","gripping","grizzled","gross","grotesque","grouchy","grounded","growing","growling","grown","grubby","gruesome","grumpy","guilty","gullible","gummy","hairy","half","handmade","handsome","handy","happy","happy-go-lucky","hard","hard-to-find","harmful","harmless","harmonious","harsh","hasty","hateful","haunting","healthy","heartfelt","hearty","heavenly","heavy","hefty","helpful","helpless","hidden","hideous","high","high-level","hilarious","hoarse","hollow","homely","honest","honorable","honored","hopeful","horrible","hospitable","hot","huge","humble","humiliating","humming","humongous","hungry","hurtful","husky","icky","icy","ideal","idealistic","identical","idle","idiotic","idolized","ignorant","ill","illegal","ill-fated","ill-informed","illiterate","illustrious","imaginary","imaginative","immaculate","immaterial","immediate","immense","impassioned","impeccable","impartial","imperfect","imperturbable","impish","impolite","important","impossible","impractical","impressionable","impressive","improbable","impure","inborn","incomparable","incompatible","incomplete","inconsequential","incredible","indelible","inexperienced","indolent","infamous","infantile","infatuated","inferior","infinite","informal","innocent","insecure","insidious","insignificant","insistent","instructive","insubstantial","intelligent","intent","intentional","interesting","internal","international","intrepid","ironclad","irresponsible","irritating","itchy","jaded","jagged","jam-packed","jaunty","jealous","jittery","joint","jolly","jovial","joyful","joyous","jubilant","judicious","juicy","jumbo","junior","jumpy","juvenile","kaleidoscopic","keen","key","kind","kindhearted","kindly","klutzy","knobby","knotty","knowledgeable","knowing","known","kooky","kosher","lame","lanky","large","last","lasting","late","lavish","lawful","lazy","leading","lean","leafy","left","legal","legitimate","light","lighthearted","likable","likely","limited","limp","limping","linear","lined","liquid","little","live","lively","livid","loathsome","lone","lonely","long","long-term","loose","lopsided","lost","loud","lovable","lovely","loving","low","loyal","lucky","lumbering","luminous","lumpy","lustrous","luxurious","mad","made-up","magnificent","majestic","major","male","mammoth","married","marvelous","masculine","massive","mature","meager","mealy","mean","measly","meaty","medical","mediocre","medium","meek","mellow","melodic","memorable","menacing","merry","messy","metallic","mild","milky","mindless","miniature","minor","minty","miserable","miserly","misguided","misty","mixed","modern","modest","moist","monstrous","monthly","monumental","moral","mortified","motherly","motionless","mountainous","muddy","muffled","multicolored","mundane","murky","mushy","musty","muted","mysterious","naive","narrow","nasty","natural","naughty","nautical","near","neat","necessary","needy","negative","neglected","negligible","neighboring","nervous","new","next","nice","nifty","nimble","nippy","nocturnal","noisy","nonstop","normal","notable","noted","noteworthy","novel","noxious","numb","nutritious","nutty","obedient","obese","oblong","oily","oblong","obvious","occasional","odd","oddball","offbeat","offensive","official","old","old-fashioned","only","open","optimal","optimistic","opulent","orange","orderly","organic","ornate","ornery","ordinary","original","other","our","outlying","outgoing","outlandish","outrageous","outstanding","oval","overcooked","overdue","overjoyed","overlooked","palatable","pale","paltry","parallel","parched","partial","passionate","past","pastel","peaceful","peppery","perfect","perfumed","periodic","perky","personal","pertinent","pesky","pessimistic","petty","phony","physical","piercing","pink","pitiful","plain","plaintive","plastic","playful","pleasant","pleased","pleasing","plump","plush","polished","polite","political","pointed","pointless","poised","poor","popular","portly","posh","positive","possible","potable","powerful","powerless","practical","precious","present","prestigious","pretty","precious","previous","pricey","prickly","primary","prime","pristine","private","prize","probable","productive","profitable","profuse","proper","proud","prudent","punctual","pungent","puny","pure","purple","pushy","putrid","puzzled","puzzling","quaint","qualified","quarrelsome","quarterly","queasy","querulous","questionable","quick","quick-witted","quiet","quintessential","quirky","quixotic","quizzical","radiant","ragged","rapid","rare","rash","raw","recent","reckless","rectangular","ready","real","realistic","reasonable","red","reflecting","regal","regular","reliable","relieved","remarkable","remorseful","remote","repentant","required","respectful","responsible","repulsive","revolving","rewarding","rich","rigid","right","ringed","ripe","roasted","robust","rosy","rotating","rotten","rough","round","rowdy","royal","rubbery","rundown","ruddy","rude","runny","rural","rusty","sad","safe","salty","same","sandy","sane","sarcastic","sardonic","satisfied","scaly","scarce","scared","scary","scented","scholarly","scientific","scornful","scratchy","scrawny","second","secondary","second-hand","secret","self-assured","self-reliant","selfish","sentimental","separate","serene","serious","serpentine","several","severe","shabby","shadowy","shady","shallow","shameful","shameless","sharp","shimmering","shiny","shocked","shocking","shoddy","short","short-term","showy","shrill","shy","sick","silent","silky","silly","silver","similar","simple","simplistic","sinful","single","sizzling","skeletal","skinny","sleepy","slight","slim","slimy","slippery","slow","slushy","small","smart","smoggy","smooth","smug","snappy","snarling","sneaky","sniveling","snoopy","sociable","soft","soggy","solid","somber","some","spherical","sophisticated","sore","sorrowful","soulful","soupy","sour","Spanish","sparkling","sparse","specific","spectacular","speedy","spicy","spiffy","spirited","spiteful","splendid","spotless","spotted","spry","square","squeaky","squiggly","stable","staid","stained","stale","standard","starchy","stark","starry","steep","sticky","stiff","stimulating","stingy","stormy","straight","strange","steel","strict","strident","striking","striped","strong","studious","stunning","stupendous","stupid","sturdy","stylish","subdued","submissive","substantial","subtle","suburban","sudden","sugary","sunny","super","superb","superficial","superior","supportive","sure-footed","surprised","suspicious","svelte","sweaty","sweet","sweltering","swift","sympathetic","tall","talkative","tame","tan","tangible","tart","tasty","tattered","taut","tedious","teeming","tempting","tender","tense","tepid","terrible","terrific","testy","thankful","that","these","thick","thin","third","thirsty","this","thorough","thorny","those","thoughtful","threadbare","thrifty","thunderous","tidy","tight","timely","tinted","tiny","tired","torn","total","tough","traumatic","treasured","tremendous","tragic","trained","tremendous","triangular","tricky","trifling","trim","trivial","troubled","true","trusting","trustworthy","trusty","truthful","tubby","turbulent","twin","ugly","ultimate","unacceptable","unaware","uncomfortable","uncommon","unconscious","understated","unequaled","uneven","unfinished","unfit","unfolded","unfortunate","unhappy","unhealthy","uniform","unimportant","unique","united","unkempt","unknown","unlawful","unlined","unlucky","unnatural","unpleasant","unrealistic","unripe","unruly","unselfish","unsightly","unsteady","unsung","untidy","untimely","untried","untrue","unused","unusual","unwelcome","unwieldy","unwilling","unwitting","unwritten","upbeat","upright","upset","urban","usable","used","useful","useless","utilized","utter","vacant","vague","vain","valid","valuable","vapid","variable","vast","velvety","venerated","vengeful","verifiable","vibrant","vicious","victorious","vigilant","vigorous","villainous","violet","violent","virtual","virtuous","visible","vital","vivacious","vivid","voluminous","wan","warlike","warm","warmhearted","warped","wary","wasteful","watchful","waterlogged","watery","wavy","wealthy","weak","weary","webbed","wee","weekly","weepy","weighty","weird","welcome","well-documented","well-groomed","well-informed","well-lit","well-made","well-off","well-to-do","well-worn","wet","which","whimsical","whirlwind","whispered","white","whole","whopping","wicked","wide","wide-eyed","wiggly","wild","willing","wilted","winding","windy","winged","wiry","wise","witty","wobbly","woeful","wonderful","wooden","woozy","wordy","worldly","worn","worried","worrisome","worse","worst","worthless","worthwhile","worthy","wrathful","wretched","writhing","wrong","wry","yawning","yearly","yellow","yellowish","young","youthful","yummy","zany","zealous","zesty","zigzag","rocky"],t=["people","history","way","art","world","information","map","family","government","health","system","computer","meat","year","thanks","music","person","reading","method","data","food","understanding","theory","law","bird","literature","problem","software","control","knowledge","power","ability","economics","love","internet","television","science","library","nature","fact","product","idea","temperature","investment","area","society","activity","story","industry","media","thing","oven","community","definition","safety","quality","development","language","management","player","variety","video","week","security","country","exam","movie","organization","equipment","physics","analysis","policy","series","thought","basis","boyfriend","direction","strategy","technology","army","camera","freedom","paper","environment","child","instance","month","truth","marketing","university","writing","article","department","difference","goal","news","audience","fishing","growth","income","marriage","user","combination","failure","meaning","medicine","philosophy","teacher","communication","night","chemistry","disease","disk","energy","nation","road","role","soup","advertising","location","success","addition","apartment","education","math","moment","painting","politics","attention","decision","event","property","shopping","student","wood","competition","distribution","entertainment","office","population","president","unit","category","cigarette","context","introduction","opportunity","performance","driver","flight","length","magazine","newspaper","relationship","teaching","cell","dealer","debate","finding","lake","member","message","phone","scene","appearance","association","concept","customer","death","discussion","housing","inflation","insurance","mood","woman","advice","blood","effort","expression","importance","opinion","payment","reality","responsibility","situation","skill","statement","wealth","application","city","county","depth","estate","foundation","grandmother","heart","perspective","photo","recipe","studio","topic","collection","depression","imagination","passion","percentage","resource","setting","ad","agency","college","connection","criticism","debt","description","memory","patience","secretary","solution","administration","aspect","attitude","director","personality","psychology","recommendation","response","selection","storage","version","alcohol","argument","complaint","contract","emphasis","highway","loss","membership","possession","preparation","steak","union","agreement","cancer","currency","employment","engineering","entry","interaction","limit","mixture","preference","region","republic","seat","tradition","virus","actor","classroom","delivery","device","difficulty","drama","election","engine","football","guidance","hotel","match","owner","priority","protection","suggestion","tension","variation","anxiety","atmosphere","awareness","bread","climate","comparison","confusion","construction","elevator","emotion","employee","employer","guest","height","leadership","mall","manager","operation","recording","respect","sample","transportation","boring","charity","cousin","disaster","editor","efficiency","excitement","extent","feedback","guitar","homework","leader","mom","outcome","permission","presentation","promotion","reflection","refrigerator","resolution","revenue","session","singer","tennis","basket","bonus","cabinet","childhood","church","clothes","coffee","dinner","drawing","hair","hearing","initiative","judgment","lab","measurement","mode","mud","orange","poetry","police","possibility","procedure","queen","ratio","relation","restaurant","satisfaction","sector","signature","significance","song","tooth","town","vehicle","volume","wife","accident","airport","appointment","arrival","assumption","baseball","chapter","committee","conversation","database","enthusiasm","error","explanation","farmer","gate","girl","hall","historian","hospital","injury","instruction","maintenance","manufacturer","meal","perception","pie","poem","presence","proposal","reception","replacement","revolution","river","son","speech","tea","village","warning","winner","worker","writer","assistance","breath","buyer","chest","chocolate","conclusion","contribution","cookie","courage","desk","drawer","establishment","examination","garbage","grocery","honey","impression","improvement","independence","insect","inspection","inspector","king","ladder","menu","penalty","piano","potato","profession","professor","quantity","reaction","requirement","salad","sister","supermarket","tongue","weakness","wedding","affair","ambition","analyst","apple","assignment","assistant","bathroom","bedroom","beer","birthday","celebration","championship","cheek","client","consequence","departure","diamond","dirt","ear","fortune","friendship","funeral","gene","girlfriend","hat","indication","intention","lady","midnight","negotiation","obligation","passenger","pizza","platform","poet","pollution","recognition","reputation","shirt","speaker","stranger","surgery","sympathy","tale","throat","trainer","uncle","youth","time","work","film","water","money","example","while","business","study","game","life","form","air","day","place","number","part","field","fish","back","process","heat","hand","experience","job","book","end","point","type","home","economy","value","body","market","guide","interest","state","radio","course","company","price","size","card","list","mind","trade","line","care","group","risk","word","fat","force","key","light","training","name","school","top","amount","level","order","practice","research","sense","service","piece","web","boss","sport","fun","house","page","term","test","answer","sound","focus","matter","kind","soil","board","oil","picture","access","garden","range","rate","reason","future","site","demand","exercise","image","case","cause","coast","action","age","bad","boat","record","result","section","building","mouse","cash","class","period","plan","store","tax","side","subject","space","rule","stock","weather","chance","figure","man","model","source","beginning","earth","program","chicken","design","feature","head","material","purpose","question","rock","salt","act","birth","car","dog","object","scale","sun","note","profit","rent","speed","style","war","bank","craft","half","inside","outside","standard","bus","exchange","eye","fire","position","pressure","stress","advantage","benefit","box","frame","issue","step","cycle","face","item","metal","paint","review","room","screen","structure","view","account","ball","discipline","medium","share","balance","bit","black","bottom","choice","gift","impact","machine","shape","tool","wind","address","average","career","culture","morning","pot","sign","table","task","condition","contact","credit","egg","hope","ice","network","north","square","attempt","date","effect","link","post","star","voice","capital","challenge","friend","self","shot","brush","couple","exit","front","function","lack","living","plant","plastic","spot","summer","taste","theme","track","wing","brain","button","click","desire","foot","gas","influence","notice","rain","wall","base","damage","distance","feeling","pair","savings","staff","sugar","target","text","animal","author","budget","discount","file","ground","lesson","minute","officer","phase","reference","register","sky","stage","stick","title","trouble","bowl","bridge","campaign","character","club","edge","evidence","fan","letter","lock","maximum","novel","option","pack","park","quarter","skin","sort","weight","baby","background","carry","dish","factor","fruit","glass","joint","master","muscle","red","strength","traffic","trip","vegetable","appeal","chart","gear","ideal","kitchen","land","log","mother","net","party","principle","relative","sale","season","signal","spirit","street","tree","wave","belt","bench","commission","copy","drop","minimum","path","progress","project","sea","south","status","stuff","ticket","tour","angle","blue","breakfast","confidence","daughter","degree","doctor","dot","dream","duty","essay","father","fee","finance","hour","juice","luck","milk","mouth","peace","pipe","stable","storm","substance","team","trick","afternoon","bat","beach","blank","catch","chain","consideration","cream","crew","detail","gold","interview","kid","mark","mission","pain","pleasure","score","screw","sex","shop","shower","suit","tone","window","agent","band","bath","block","bone","calendar","candidate","cap","coat","contest","corner","court","cup","district","door","east","finger","garage","guarantee","hole","hook","implement","layer","lecture","lie","manner","meeting","nose","parking","partner","profile","rice","routine","schedule","swimming","telephone","tip","winter","airline","bag","battle","bed","bill","bother","cake","code","curve","designer","dimension","dress","ease","emergency","evening","extension","farm","fight","gap","grade","holiday","horror","horse","host","husband","loan","mistake","mountain","nail","noise","occasion","package","patient","pause","phrase","proof","race","relief","sand","sentence","shoulder","smoke","stomach","string","tourist","towel","vacation","west","wheel","wine","arm","aside","associate","bet","blow","border","branch","breast","brother","buddy","bunch","chip","coach","cross","document","draft","dust","expert","floor","god","golf","habit","iron","judge","knife","landscape","league","mail","mess","native","opening","parent","pattern","pin","pool","pound","request","salary","shame","shelter","shoe","silver","tackle","tank","trust","assist","bake","bar","bell","bike","blame","boy","brick","chair","closet","clue","collar","comment","conference","devil","diet","fear","fuel","glove","jacket","lunch","monitor","mortgage","nurse","pace","panic","peak","plane","reward","row","sandwich","shock","spite","spray","surprise","till","transition","weekend","welcome","yard","alarm","bend","bicycle","bite","blind","bottle","cable","candle","clerk","cloud","concert","counter","flower","grandfather","harm","knee","lawyer","leather","load","mirror","neck","pension","plate","purple","ruin","ship","skirt","slice","snow","specialist","stroke","switch","trash","tune","zone","anger","award","bid","bitter","boot","bug","camp","candy","carpet","cat","champion","channel","clock","comfort","cow","crack","engineer","entrance","fault","grass","guy","hell","highlight","incident","island","joke","jury","leg","lip","mate","motor","nerve","passage","pen","pride","priest","prize","promise","resident","resort","ring","roof","rope","sail","scheme","script","sock","station","toe","tower","truck","witness","can","will","other","use","make","good","look","help","go","great","being","still","public","read","keep","start","give","human","local","general","specific","long","play","feel","high","put","common","set","change","simple","past","big","possible","particular","major","personal","current","national","cut","natural","physical","show","try","check","second","call","move","pay","let","increase","single","individual","turn","ask","buy","guard","hold","main","offer","potential","professional","international","travel","cook","alternative","special","working","whole","dance","excuse","cold","commercial","low","purchase","deal","primary","worth","fall","necessary","positive","produce","search","present","spend","talk","creative","tell","cost","drive","green","support","glad","remove","return","run","complex","due","effective","middle","regular","reserve","independent","leave","original","reach","rest","serve","watch","beautiful","charge","active","break","negative","safe","stay","visit","visual","affect","cover","report","rise","walk","white","junior","pick","unique","classic","final","lift","mix","private","stop","teach","western","concern","familiar","fly","official","broad","comfortable","gain","rich","save","stand","young","heavy","lead","listen","valuable","worry","handle","leading","meet","release","sell","finish","normal","press","ride","secret","spread","spring","tough","wait","brown","deep","display","flow","hit","objective","shoot","touch","cancel","chemical","cry","dump","extreme","push","conflict","eat","fill","formal","jump","kick","opposite","pass","pitch","remote","total","treat","vast","abuse","beat","burn","deposit","print","raise","sleep","somewhere","advance","consist","dark","double","draw","equal","fix","hire","internal","join","kill","sensitive","tap","win","attack","claim","constant","drag","drink","guess","minor","pull","raw","soft","solid","wear","weird","wonder","annual","count","dead","doubt","feed","forever","impress","repeat","round","sing","slide","strip","wish","combine","command","dig","divide","equivalent","hang","hunt","initial","march","mention","spiritual","survey","tie","adult","brief","crazy","escape","gather","hate","prior","repair","rough","sad","scratch","sick","strike","employ","external","hurt","illegal","laugh","lay","mobile","nasty","ordinary","respond","royal","senior","split","strain","struggle","swim","train","upper","wash","yellow","convert","crash","dependent","fold","funny","grab","hide","miss","permit","quote","recover","resolve","roll","sink","slip","spare","suspect","sweet","swing","twist","upstairs","usual","abroad","brave","calm","concentrate","estimate","grand","male","mine","prompt","quiet","refuse","regret","reveal","rush","shake","shift","shine","steal","suck","surround","bear","brilliant","dare","dear","delay","drunk","female","hurry","inevitable","invite","kiss","neat","pop","punch","quit","reply","representative","resist","rip","rub","silly","smile","spell","stretch","stupid","tear","temporary","tomorrow","wake","wrap","yesterday","Thomas","Tom","Lieuwe"];return F(e[U(0,e.length+1)])+" "+F(t[U(0,t.length+1)])}var W,H=n(405),q=(n(351),n(272)),K=n(261),G=n(29),$=(n(355),n(0)),J=function(e){var t=e.user,n=e.socket,a=e.userToManage,s=e.trigger,o=e.displayName,c=e.position,l=e.disabled,d=Object(u.useState)(!1),h=Object(G.a)(d,2),p=h[0],m=h[1];return Object($.jsxs)(B.a,{className:"userMenu",trigger:s,on:"click",open:p,onOpen:function(){return m(!0)},onClose:function(){return m(!1)},position:c,disabled:l,children:[Object($.jsx)("div",{className:"userMenuHeader",children:o}),Object($.jsx)("div",{className:"userMenuContent",children:Object($.jsx)(R.a,{content:"Kick",negative:!0,icon:"ban",onClick:Object(r.a)(i.a.mark((function e(){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===t||void 0===t?void 0:t.getIdToken();case 2:r=e.sent,n.emit("kickUser",{userToBeKicked:a,uid:null===t||void 0===t?void 0:t.uid,token:r}),m(!1);case 5:case"end":return e.stop()}}),e)})))})})]})},X=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={chatMsg:"",isNearBottom:!0,isPickerOpen:!1},e.messagesRef=d.a.createRef(),e.updateChatMsg=function(t,n){e.setState({chatMsg:n.value})},e.sendChatMsg=function(){e.state.chatMsg&&(e.chatTooLong()||(e.setState({chatMsg:""}),e.props.socket.emit("CMD:chat",e.state.chatMsg)))},e.chatTooLong=function(){var t;return Boolean((null===(t=e.state.chatMsg)||void 0===t?void 0:t.length)>1e4)},e.onScroll=function(){e.setState({isNearBottom:e.isChatNearBottom()})},e.isChatNearBottom=function(){return e.messagesRef.current&&e.messagesRef.current.scrollHeight-e.messagesRef.current.scrollTop-e.messagesRef.current.offsetHeight<100},e.scrollToBottom=function(){e.messagesRef.current&&(e.messagesRef.current.scrollTop=e.messagesRef.current.scrollHeight)},e.formatMessage=function(t,n){return"host"===t?Object($.jsxs)(d.a.Fragment,{children:["changed the video to ",Object($.jsx)("span",{style:{textTransform:"initial"},children:e.props.getMediaDisplayName(n)})]}):"playlistAdd"===t?Object($.jsxs)(d.a.Fragment,{children:["added to the playlist: ",Object($.jsx)("span",{style:{textTransform:"initial"},children:e.props.getMediaDisplayName(n)})]}):"seek"===t?"jumped to ".concat(Object(z.f)(n)):"play"===t?"started the video at ".concat(Object(z.f)(n)):"pause"===t?"paused the video at ".concat(Object(z.f)(n)):"lock"===t?"locked the room":"unlock"===t?"unlocked the room":"vBrowserTimeout"===t?Object($.jsxs)(d.a.Fragment,{children:["The VBrowser shut down automatically.",Object($.jsx)("br",{}),"Subscribe for longer sessions."]}):"vBrowserAlmostTimeout"===t?Object($.jsxs)(d.a.Fragment,{children:["The VBrowser will shut down soon.",Object($.jsx)("br",{}),"Subscribe for longer sessions."]}):t},e.addEmoji=function(t){e.setState({chatMsg:e.state.chatMsg+t.native})},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e;this.scrollToBottom(),null===(e=this.messagesRef.current)||void 0===e||e.addEventListener("scroll",this.onScroll)}},{key:"componentDidUpdate",value:function(e){this.props.scrollTimestamp!==e.scrollTimestamp&&(0===e.scrollTimestamp||this.state.isNearBottom)&&this.scrollToBottom(),this.props.hide!==e.hide&&this.scrollToBottom()}},{key:"render",value:function(){var e=this;return Object($.jsxs)("div",{className:this.props.className,style:{display:this.props.hide?"none":"flex",flexDirection:"column",flexGrow:1,minHeight:0,marginTop:0,marginBottom:0,padding:"8px"},children:[Object($.jsxs)("div",{className:"chatContainer",ref:this.messagesRef,style:{position:"relative"},children:[Object($.jsx)(H.a.Group,{children:this.props.chat.map((function(t){return Object($.jsx)(Q,{message:t,pictureMap:e.props.pictureMap,nameMap:e.props.nameMap,formatMessage:e.formatMessage,owner:e.props.owner,user:e.props.user,socket:e.props.socket},t.timestamp+t.id)}))}),!this.state.isNearBottom&&Object($.jsx)(R.a,{size:"tiny",onClick:this.scrollToBottom,style:{position:"sticky",bottom:0,display:"block",margin:"0 auto"},children:"Jump to bottom"})]}),Object($.jsx)(bt,{}),this.state.isPickerOpen&&Object($.jsx)(ee,{addEmoji:this.addEmoji,closeMenu:function(){return e.setState({isPickerOpen:!1})}}),Object($.jsxs)(S.a,{inverted:!0,fluid:!0,onKeyPress:function(t){return"Enter"===t.key&&e.sendChatMsg()},onChange:this.updateChatMsg,value:this.state.chatMsg,error:this.chatTooLong(),icon:!0,disabled:this.props.isChatDisabled,placeholder:this.props.isChatDisabled?"The chat was disabled by the room owner.":"Enter a message...",children:[Object($.jsx)("input",{}),Object($.jsx)(C.a,{onClick:function(){return e.setState({isPickerOpen:!0})},name:"",inverted:!0,circular:!0,link:!0,disabled:this.props.isChatDisabled,style:{opacity:1},children:Object($.jsx)("span",{role:"img","aria-label":"Emoji",children:"\ud83d\ude00"})})]})]})}}]),n}(d.a.Component),Q=function(e){var t=e.message,n=e.nameMap,a=e.pictureMap,i=e.formatMessage,r=e.user,s=e.socket,o=e.owner,c=t.id,l=t.timestamp,u=t.cmd,d=t.msg,h=t.system;return Object($.jsxs)(H.a,{children:[c?Object($.jsx)(H.a.Avatar,{src:a[c]||Object(z.j)(n[c],Object(z.i)(c))}):null,Object($.jsxs)(H.a.Content,{children:[Object($.jsx)(J,{displayName:n[c]||c,user:r,socket:s,userToManage:c,disabled:!Boolean(o&&o===(null===r||void 0===r?void 0:r.uid)),trigger:Object($.jsxs)(H.a.Author,{as:"a",className:"light",children:[Boolean(h)&&"System",n[c]||c]})}),Object($.jsx)(H.a.Metadata,{className:"dark",children:Object($.jsx)("div",{children:new Date(l).toLocaleTimeString()})}),Object($.jsx)(H.a.Text,{className:"light system",children:u&&i(u,d)}),Object($.jsx)(H.a.Text,{className:"light",children:!u&&d})]})]})},Z=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).handleClickOutside=function(){e.props.closeMenu()},e}return Object(o.a)(n,[{key:"render",value:function(){return Object($.jsx)("div",{style:{position:"absolute",bottom:"60px"},children:Object($.jsx)(q.a,{set:"google",sheetSize:64,theme:"dark",showPreview:!1,showSkinTones:!1,onSelect:this.props.addEmoji})})}}]),n}(d.a.Component),ee=Object(K.a)(Z),te=n(274),ne=n(46),ae=(n(214),n(404)),ie=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={email:"",password:"",isCreateMode:!1,error:""},e.resetPassword=Object(r.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ne.a.auth().sendPasswordResetEmail(e.state.email);case 3:e.props.closeLogin(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),e.setState({error:t.t0.message});case 9:case"end":return t.stop()}}),t,null,[[0,6]])}))),e.emailSignIn=function(){var t=Object(r.a)(i.a.mark((function t(n,a){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ne.a.auth().signInWithEmailAndPassword(n,a);case 3:e.props.closeLogin(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),e.setState({error:t.t0.message});case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e,n){return t.apply(this,arguments)}}(),e.createAccount=function(){var t=Object(r.a)(i.a.mark((function t(n,a){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ne.a.auth().createUserWithEmailAndPassword(n,a);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),e.setState({error:t.t0.message});case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e,n){return t.apply(this,arguments)}}(),e.emailLinkSignIn=Object(r.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ne.a.auth().sendSignInLinkToEmail(e.state.email,{url:window.location.href,handleCodeInApp:!0});case 2:case"end":return t.stop()}}),t)}))),e}return Object(o.a)(n,[{key:"render",value:function(){var e=this,t=this.props.closeLogin;return Object($.jsxs)(P.a,{open:!0,onClose:t,children:[Object($.jsx)(P.a.Header,{children:this.state.isCreateMode?"Create an account":"Login"}),Object($.jsxs)(P.a.Content,{children:[this.state.error&&Object($.jsx)(D.a,{color:"red",header:"Error",content:this.state.error}),Object($.jsxs)(ae.a,{children:[Object($.jsxs)(ae.a.Field,{children:[Object($.jsx)("label",{children:"Email"}),Object($.jsx)("input",{placeholder:"Email",value:this.state.email,onChange:function(t){return e.setState({email:t.target.value})}})]}),Object($.jsxs)(ae.a.Field,{children:[Object($.jsx)("label",{children:"Password"}),Object($.jsx)("input",{type:"password",placeholder:"Password",value:this.state.password,onChange:function(t){return e.setState({password:t.target.value})}})]}),!this.state.isCreateMode&&Object($.jsxs)("div",{children:["Don't have an account?"," ",Object($.jsx)("button",{type:"button",className:"linkButton",onClick:function(){return e.setState({isCreateMode:!0})},children:"Create one."})," ","Forgot your password? Enter your email and"," ",Object($.jsx)("button",{type:"button",className:"linkButton",onClick:this.resetPassword,children:"reset it."})]}),this.state.isCreateMode?Object($.jsx)(R.a,{type:"submit",onClick:function(){return e.createAccount(e.state.email,e.state.password)},children:"Create"}):Object($.jsx)(R.a,{type:"submit",onClick:function(){return e.emailSignIn(e.state.email,e.state.password)},children:"Login"})]})]})]})}}]),n}(d.a.Component),re=n(413),se=n(407),oe=n(266),ce=Object(oe.a)("pk_live_eVMbIifj5lnvgBleBCRaCv4E00aeXQkPxQ"),le=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).onSubscribe=Object(r.a)(i.a.mark((function t(){var n,a,r,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(ce){t.next=3;break}return console.warn("Stripe integration is not configured, cannot subscribe"),t.abrupt("return");case 3:return t.next=5,ce;case 5:return r=t.sent,t.next=8,null===r||void 0===r?void 0:r.redirectToCheckout({lineItems:[{price:"price_HNDBoPDI7yYRi9",quantity:1}],mode:"subscription",successUrl:window.location.href,cancelUrl:window.location.href,customerEmail:null===(n=e.props.user)||void 0===n?void 0:n.email,clientReferenceId:null===(a=e.props.user)||void 0===a?void 0:a.uid});case 8:(s=t.sent)&&s.error&&console.error(s.error.message);case 10:case"end":return t.stop()}}),t)}))),e}return Object(o.a)(n,[{key:"render",value:function(){if(this.props.isSubscriber)return this.props.closeSubscribe(),null;var e=this.props.closeSubscribe;return Object($.jsxs)(P.a,{open:!0,onClose:e,children:[Object($.jsx)(P.a.Header,{children:"Subscribe to WatchParty Plus"}),Object($.jsx)(P.a.Content,{image:!0,children:Object($.jsxs)(P.a.Description,{children:[Object($.jsx)("div",{children:"Subscriptions help us maintain the service and build new features! Please consider supporting us if you're enjoying WatchParty."}),Object($.jsx)(re.a,{children:"Features"}),Object($.jsxs)(se.a,{definition:!0,unstackable:!0,striped:!0,celled:!0,children:[Object($.jsx)(se.a.Header,{children:Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.HeaderCell,{}),Object($.jsx)(se.a.HeaderCell,{children:"WatchParty Free"}),Object($.jsx)(se.a.HeaderCell,{children:"WatchParty Plus"})]})}),Object($.jsxs)(se.a.Body,{children:[Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"Basic (Synchronized watching, chat, screenshare)"}),Object($.jsx)(se.a.Cell,{children:Object($.jsx)(C.a,{name:"check"})}),Object($.jsx)(se.a.Cell,{children:Object($.jsx)(C.a,{name:"check"})})]}),Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"VBrowser Access"}),Object($.jsx)(se.a.Cell,{children:"When capacity allows"}),Object($.jsx)(se.a.Cell,{children:"Anytime"})]}),Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"VBrowser Resolution"}),Object($.jsx)(se.a.Cell,{children:"720p"}),Object($.jsx)(se.a.Cell,{children:"1080p"})]}),Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"VBrowser CPU/RAM"}),Object($.jsx)(se.a.Cell,{children:"Standard"}),Object($.jsx)(se.a.Cell,{children:"Extra"})]}),Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"VBrowser Session Length"}),Object($.jsx)(se.a.Cell,{children:"3 hours"}),Object($.jsx)(se.a.Cell,{children:"24 hours"})]}),Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"Number of Permanent Rooms"}),Object($.jsx)(se.a.Cell,{children:"1"}),Object($.jsx)(se.a.Cell,{children:"20"})]}),Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"Custom Room URLs"}),Object($.jsx)(se.a.Cell,{}),Object($.jsx)(se.a.Cell,{children:Object($.jsx)(C.a,{name:"check"})})]}),Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"Discord Subscriber Role (on request)"}),Object($.jsx)(se.a.Cell,{}),Object($.jsx)(se.a.Cell,{children:Object($.jsx)(C.a,{name:"check"})})]}),Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"Price"}),Object($.jsx)(se.a.Cell,{children:"$0 / month"}),Object($.jsx)(se.a.Cell,{children:"$5 / month"})]})]})]}),Object($.jsx)("div",{style:{textAlign:"right"},children:this.props.user&&this.props.user.email?Object($.jsxs)(R.a,{icon:!0,labelPosition:"left",color:"blue",size:"large",onClick:this.onSubscribe,children:[Object($.jsx)(C.a,{name:"cc stripe"}),"Subscribe with Stripe"]}):Object($.jsxs)("div",{children:["Please sign in to subscribe: ",Object($.jsx)(pe,{user:void 0})]})})]})})]})}}]),n}(d.a.Component),ue=function(e){var t=e.user,n=e.isSubscriber,a=(e.isCustomer,Object(u.useState)(!1)),s=Object(G.a)(a,2),o=s[0],c=s[1],l=Object(u.useCallback)(Object(r.a)(i.a.mark((function e(){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=window,e.t1=z.s+"/manageSub",e.t2={"Content-Type":"application/json"},e.t3=JSON,e.t4=null===t||void 0===t?void 0:t.uid,e.next=7,null===t||void 0===t?void 0:t.getIdToken();case 7:return e.t5=e.sent,e.t6=window.location.href,e.t7={uid:e.t4,token:e.t5,return_url:e.t6},e.t8=e.t3.stringify.call(e.t3,e.t7),e.t9={method:"POST",headers:e.t2,body:e.t8},e.next=14,e.t0.fetch.call(e.t0,e.t1,e.t9);case 14:return n=e.sent,e.next=17,n.json();case 17:a=e.sent,console.log(a),window.location.assign(a.url);case 20:case"end":return e.stop()}}),e)}))),[t]);return Object($.jsxs)($.Fragment,{children:[o&&Object($.jsx)(le,{user:t,isSubscriber:n,closeSubscribe:function(){return c(!1)}}),!n&&Object($.jsx)(B.a,{content:"Subscribe to help support us and enable additional features!",trigger:Object($.jsxs)(R.a,{fluid:!0,color:"orange",className:"toolButton",icon:!0,labelPosition:"left",onClick:function(){return c(!0)},children:[Object($.jsx)(C.a,{name:"plus"}),"Subscribe"]})}),n&&Object($.jsx)(B.a,{content:"Manage your subscription",trigger:Object($.jsxs)(R.a,{fluid:!0,color:"orange",className:"toolButton",icon:!0,labelPosition:"left",onClick:l,children:[Object($.jsx)(C.a,{name:"wrench"}),"Manage"]})})]})},de=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={resetDisabled:!1},e.onSignOut=function(){ne.a.auth().signOut(),window.location.reload()},e.resetPassword=Object(r.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.props.user.email){t.next=5;break}return t.next=4,ne.a.auth().sendPasswordResetEmail(e.props.user.email);case 4:e.setState({resetDisabled:!0});case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.warn(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])}))),e}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props,t=e.close,n=e.userImage;return Object($.jsxs)(P.a,{open:!0,onClose:t,children:[Object($.jsxs)(P.a.Header,{children:[Object($.jsx)(te.a,{avatar:!0,src:n}),this.props.user.email]}),Object($.jsx)(P.a.Content,{children:Object($.jsxs)("div",{style:{width:"300px",display:"flex",alignItems:"center",flexDirection:"column",gap:"10px"},children:[Object($.jsxs)(R.a,{icon:!0,labelPosition:"left",fluid:!0,href:"https://gravatar.com",target:"_blank",color:"blue",children:[Object($.jsx)(C.a,{name:"image"}),"Edit Gravatar"]}),Object($.jsxs)(R.a,{disabled:this.state.resetDisabled,icon:!0,labelPosition:"left",fluid:!0,color:"green",onClick:this.resetPassword,children:[Object($.jsx)(C.a,{name:"key"}),"Reset Password"]}),Object($.jsxs)(R.a,{icon:!0,labelPosition:"left",onClick:this.onSignOut,color:"red",fluid:!0,children:[Object($.jsx)(C.a,{name:"sign out"}),"Sign out"]})]})})]})}}]),n}(d.a.Component),he=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).createRoom=Object(r.a)(i.a.mark((function t(){var n,a,r,s,o,c,l;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=null===(n=e.props.user)||void 0===n?void 0:n.uid,t.next=3,null===(a=e.props.user)||void 0===a?void 0:a.getIdToken();case 3:return s=t.sent,t.next=6,window.fetch(z.s+"/createRoom",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:r,token:s})});case 6:return o=t.sent,t.next=9,o.json();case 9:c=t.sent,l=c.name,e.props.openNewTab?window.open("/#"+l):window.location.assign("/#"+l);case 12:case"end":return t.stop()}}),t)}))),e}return Object(o.a)(n,[{key:"render",value:function(){return Object($.jsx)(B.a,{content:"Create a new room with a random URL that you can share with friends",trigger:Object($.jsxs)(R.a,{color:"blue",size:this.props.size,icon:!0,labelPosition:"left",onClick:this.createRoom,className:"toolButton",fluid:!0,children:[Object($.jsx)(C.a,{name:"certificate"}),"New Room"]})})}}]),n}(d.a.Component),pe=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={isLoginOpen:!1,isProfileOpen:!1,userImage:null},e.facebookSignIn=Object(r.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new ne.a.auth.FacebookAuthProvider,e.next=3,ne.a.auth().signInWithPopup(t);case 3:case"end":return e.stop()}}),e)}))),e.googleSignIn=Object(r.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new ne.a.auth.GoogleAuthProvider,e.next=3,ne.a.auth().signInWithPopup(t);case 3:case"end":return e.stop()}}),e)}))),e.signOut=function(){ne.a.auth().signOut(),window.location.reload()},e}return Object(o.a)(n,[{key:"componentDidUpdate",value:function(){var e=Object(r.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.user||!this.props.user){e.next=7;break}return e.t0=this,e.next=4,Object(z.n)(this.props.user);case 4:e.t1=e.sent,e.t2={userImage:e.t1},e.t0.setState.call(e.t0,e.t2);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.props.user?Object($.jsxs)("div",{style:{margin:"4px",width:"100px",alignItems:"center",cursor:"pointer"},children:[Object($.jsx)(te.a,{avatar:!0,src:this.state.userImage,onClick:function(){return e.setState({isProfileOpen:!0})}}),this.state.isProfileOpen&&this.props.user&&Object($.jsx)(de,{user:this.props.user,userImage:this.state.userImage,close:function(){return e.setState({isProfileOpen:!1})}})]}):Object($.jsxs)(d.a.Fragment,{children:[this.state.isLoginOpen&&Object($.jsx)(ie,{closeLogin:function(){return e.setState({isLoginOpen:!1})}}),Object($.jsx)(B.a,{basic:!0,content:"Sign in to set your name and picture, subscribe, or launch VBrowsers",trigger:Object($.jsx)(E.a,{style:{height:"36px"},icon:"sign in",labeled:!0,className:"icon",button:!0,text:"Sign in",fluid:this.props.fluid,children:Object($.jsxs)(E.a.Menu,{children:[Object($.jsxs)(E.a.Item,{onClick:this.facebookSignIn,children:[Object($.jsx)(C.a,{name:"facebook"}),"Facebook"]}),Object($.jsxs)(E.a.Item,{onClick:this.googleSignIn,children:[Object($.jsx)(C.a,{name:"google"}),"Google"]}),Object($.jsxs)(E.a.Item,{onClick:function(){return e.setState({isLoginOpen:!0})},children:[Object($.jsx)(C.a,{name:"mail"}),"Email"]})]})})})]})}}]),n}(d.a.Component),me=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={rooms:[]},e.refreshRooms=Object(r.a)(i.a.mark((function t(){var n,a,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.props.user){t.next=8;break}return t.next=3,e.props.user.getIdToken();case 3:return a=t.sent,t.next=6,w.a.get(z.s+"/listRooms?uid=".concat(null===(n=e.props.user)||void 0===n?void 0:n.uid,"&token=").concat(a));case 6:r=t.sent,e.setState({rooms:r.data});case 8:case"end":return t.stop()}}),t)}))),e.deleteRoom=function(){var t=Object(r.a)(i.a.mark((function t(n){var a,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.props.user){t.next=8;break}return t.next=3,e.props.user.getIdToken();case 3:return r=t.sent,t.next=6,w.a.delete(z.s+"/deleteRoom?uid=".concat(null===(a=e.props.user)||void 0===a?void 0:a.uid,"&token=").concat(r,"&roomId=").concat(n));case 6:e.setState({rooms:e.state.rooms.filter((function(e){return e.roomId!==n}))}),e.refreshRooms();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.refreshRooms()}},{key:"render",value:function(){var e=this;return Object($.jsx)(E.a,{style:{height:"36px"},icon:"group",labeled:!0,className:"icon",button:!0,text:"My Rooms",onClick:this.refreshRooms,scrolling:!0,children:Object($.jsxs)(E.a.Menu,{children:[0===this.state.rooms.length&&Object($.jsx)(E.a.Item,{disabled:!0,children:"You have no permanent rooms."}),this.state.rooms.map((function(t){return Object($.jsx)(E.a.Item,{link:!0,href:t.vanity?"/r/"+t.vanity:"/"+t.roomId.replace("/","#"),onClick:function(){t.vanity||setTimeout((function(){return window.location.reload()}),100)},children:Object($.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[t.vanity?"/r/".concat(t.vanity):t.roomId.replace("/","#"),Object($.jsx)("div",{style:{marginLeft:"auto",paddingLeft:"20px"},children:Object($.jsx)(R.a,{icon:!0,onClick:function(n){n.stopPropagation(),n.nativeEvent.stopImmediatePropagation(),e.deleteRoom(t.roomId)},color:"red",size:"mini",children:Object($.jsx)(C.a,{name:"trash"})})})]})})}))]})})}}]),n}(d.a.Component),be=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e,t,n=Object($.jsx)(ue,{user:this.props.user,isSubscriber:null!==(e=this.props.isSubscriber)&&void 0!==e&&e,isCustomer:null!==(t=this.props.isCustomer)&&void 0!==t&&t});return Object($.jsx)(d.a.Fragment,{children:Object($.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",padding:"1em",paddingBottom:"0px"},children:[Object($.jsxs)("a",{href:"/",style:{display:"flex"},children:[Object($.jsxs)("div",{style:{height:"48px",width:"48px",marginRight:"10px",borderRadius:"50%",position:"relative",backgroundColor:"#"+z.b.blue},children:[Object($.jsx)(C.a,{inverted:!0,name:"film",size:"large",style:{position:"absolute",top:8,width:"100%",margin:"0 auto"}}),Object($.jsx)(C.a,{inverted:!0,name:"group",size:"large",color:"green",style:{position:"absolute",bottom:8,width:"100%",margin:"0 auto"}})]}),Object($.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object($.jsx)("div",{style:{textTransform:"uppercase",fontWeight:700,color:"#2185d0",fontSize:"30px",lineHeight:"30px"},children:"Watch"}),Object($.jsx)("div",{style:{textTransform:"uppercase",fontWeight:700,color:"#21ba45",fontSize:"30px",lineHeight:"30px",marginLeft:"auto"},children:"Party"})]})]}),Object($.jsxs)("div",{style:{display:"flex",marginLeft:"10px",alignItems:"center"},children:[Object($.jsx)("a",{href:"https://discord.gg/3rYj5HV",target:"_blank",rel:"noopener noreferrer",className:"footerIcon",title:"Discord",children:Object($.jsx)(C.a,{name:"discord",size:"big",link:!0})}),Object($.jsx)("a",{href:"https://github.com/howardchung/watchparty",target:"_blank",rel:"noopener noreferrer",className:"footerIcon",title:"GitHub",children:Object($.jsx)(C.a,{name:"github",size:"big",link:!0})})]}),Object($.jsxs)("div",{className:"mobileStack",style:{display:"flex",marginLeft:"auto",gap:"4px"},children:[!this.props.hideNewRoom&&Object($.jsx)(he,{user:this.props.user,openNewTab:!0}),!this.props.hideMyRooms&&this.props.user&&Object($.jsx)(me,{user:this.props.user}),n,!this.props.hideSignin&&Object($.jsx)(pe,{user:this.props.user})]})]})})}}]),n}(d.a.Component),fe=n(275),je=n(249),ge=1,ve=2,ye=3,we=4,xe="CONNECTING",Oe="CONNECTED",ke="DISCONNECTED",Se="TRACK",Ce="MESSAGE",Te="DATA",Me={DISCONNECT:"system/disconnect"},Pe={ANSWER:"signal/answer",PROVIDE:"signal/provide"},Re={LOCKED:"control/locked",RELEASE:"control/release",REQUEST:"control/request",REQUESTING:"control/requesting",CLIPBOARD:"control/clipboard",GIVE:"control/give"},De={CONFIGURATIONS:"screen/configurations",RESOLUTION:"screen/resolution",SET:"screen/set"},Be={BAN:"admin/ban",KICK:"admin/kick",LOCK:"admin/lock",UNLOCK:"admin/unlock",MUTE:"admin/mute",UNMUTE:"admin/unmute",CONTROL:"admin/control",RELEASE:"admin/release",GIVE:"admin/give"},Ee=["event"];W=Ce;var Ie=function(e,t){Object(c.a)(a,e);var n=Object(l.a)(a);function a(){var e;Object(s.a)(this,a);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(e=n.call.apply(n,[this].concat(i)))._ws=void 0,e._peer=void 0,e._channel=void 0,e._timeout=void 0,e._displayname=void 0,e._state="disconnected",e._id="",e}return Object(o.a)(a,[{key:"id",get:function(){return this._id}},{key:"supported",get:function(){return"undefined"!==typeof RTCPeerConnection&&"undefined"!==typeof RTCPeerConnection.prototype.addTransceiver}},{key:"socketOpen",get:function(){return"undefined"!==typeof this._ws&&this._ws.readyState===WebSocket.OPEN}},{key:"peerConnected",get:function(){return"undefined"!==typeof this._peer&&["connected","checking","completed"].includes(this._state)}},{key:"connected",get:function(){return this.peerConnected&&this.socketOpen}},{key:"connect",value:function(e,t,n){var a=this;if(this.socketOpen)this.emit("warn","attempting to create websocket while connection open");else if(this.supported){if(""===n)throw new Error("Must add a displayname");this._displayname=n,this[xe]();try{this._ws=new WebSocket("".concat(e,"ws?password=").concat(t)),this.emit("debug","connecting to ".concat(this._ws.url)),this._ws.onmessage=this.onMessage.bind(this),this._ws.onerror=function(e){return a.onError.bind(a)},this._ws.onclose=function(e){return a.onDisconnected.bind(a,new Error("websocket closed"))},this._timeout=setTimeout(this.onTimeout.bind(this),15e3)}catch(i){this.onDisconnected(i)}}else this.onDisconnected(new Error("browser does not support webrtc (RTCPeerConnection missing)"))}},{key:"disconnect",value:function(){if(this._timeout&&clearTimeout(this._timeout),this.socketOpen){try{this._ws.close()}catch(e){}this._ws=void 0}if(this.peerConnected){try{this._peer.close()}catch(e){}this._peer=void 0}this._state="disconnected",this._displayname=void 0,this._id=""}},{key:"sendData",value:function(e,t){if(this.connected){var n,a;switch(e){case"mousemove":n=new ArrayBuffer(7),(a=new DataView(n)).setUint8(0,ge),a.setUint16(1,4,!0),a.setUint16(3,t.x,!0),a.setUint16(5,t.y,!0);break;case"wheel":n=new ArrayBuffer(7),(a=new DataView(n)).setUint8(0,ve),a.setUint16(1,4,!0),a.setInt16(3,t.x,!0),a.setInt16(5,t.y,!0);break;case"keydown":case"mousedown":n=new ArrayBuffer(5),(a=new DataView(n)).setUint8(0,ye),a.setUint16(1,1,!0),a.setUint16(3,t.key,!0);break;case"keyup":case"mouseup":n=new ArrayBuffer(5),(a=new DataView(n)).setUint8(0,we),a.setUint16(1,1,!0),a.setUint16(3,t.key,!0);break;default:this.emit("warn","unknown data event: ".concat(e))}"undefined"!==typeof n&&this._channel.send(n)}else this.emit("warn","attempting to send data while disconnected")}},{key:"sendMessage",value:function(e,t){this.connected?(this.emit("debug","sending event '".concat(e,"' ").concat(t?"with payload: ":""),t),this._ws.send(JSON.stringify(Object(j.a)({event:e},t)))):this.emit("warn","attempting to send message while disconnected")}},{key:"createPeer",value:function(e,t,n){var a=this;this.emit("debug","creating peer"),this.socketOpen?this.peerConnected?this.emit("warn","attempting to create peer while connected"):(this._peer=new RTCPeerConnection,!0!==t&&(this._peer=new RTCPeerConnection({iceServers:n?[{urls:n}]:Object(z.p)()})),this._peer.onconnectionstatechange=function(e){a.emit("debug","peer connection state changed",a._peer?a._peer.connectionState:void 0)},this._peer.onsignalingstatechange=function(e){a.emit("debug","peer signaling state changed",a._peer?a._peer.signalingState:void 0)},this._peer.oniceconnectionstatechange=function(e){switch(a._state=a._peer.iceConnectionState,a.emit("debug","peer ice connection state changed: ".concat(a._peer.iceConnectionState)),a._state){case"checking":a._timeout&&clearTimeout(a._timeout);break;case"connected":a.onConnected();break;case"failed":a.onDisconnected(new Error("peer failed"));break;case"disconnected":a.onDisconnected(new Error("peer disconnected"))}},this._peer.ontrack=this.onTrack.bind(this),this._peer.addTransceiver("audio",{direction:"recvonly"}),this._peer.addTransceiver("video",{direction:"recvonly"}),this._channel=this._peer.createDataChannel("data"),this._channel.onerror=this.onError.bind(this),this._channel.onmessage=this.onData.bind(this),this._channel.onclose=this.onDisconnected.bind(this,new Error("peer data channel closed")),this._peer.setRemoteDescription({type:"offer",sdp:e}),this._peer.createAnswer().then((function(e){a._peer.setLocalDescription(e),a._ws.send(JSON.stringify({event:Pe.ANSWER,sdp:e.sdp,displayname:a._displayname}))})).catch((function(e){return a.emit("error",e)}))):this.emit("warn","attempting to create peer with no websocket: ",this._ws?"state: ".concat(this._ws.readyState):"no socket")}},{key:"onMessage",value:function(e){var t=JSON.parse(e.data),n=t.event,a=Object(fe.a)(t,Ee);if(this.emit("debug","received websocket event ".concat(n," ").concat(a?"with payload: ":""),a),n===Pe.PROVIDE){var i=a,r=i.sdp,s=i.lite,o=i.ice,c=i.id;return this._id=c,void this.createPeer(r,s,o)}"function"===typeof this[n]?this[n](a):this[Ce](n,a)}},{key:"onData",value:function(e){this[Te](e.data)}},{key:"onTrack",value:function(e){this.emit("debug","received ".concat(e.track.kind," track from peer: ").concat(e.track.id),e),e.streams[0]?this[Se](e):this.emit("warn","no stream provided for track ".concat(e.track.id,"(").concat(e.track.label,")"))}},{key:"onError",value:function(e){this.emit("error",e.error)}},{key:"onConnected",value:function(){this._timeout&&clearTimeout(this._timeout),this.connected?(this.emit("debug","connected"),this[Oe]()):this.emit("warn","onConnected called while being disconnected")}},{key:"onTimeout",value:function(){this.emit("debug","connection timeout"),this._timeout&&clearTimeout(this._timeout),this.onDisconnected(new Error("connection timeout"))}},{key:"onDisconnected",value:function(e){this.disconnect(),this.emit("debug","disconnected:",e),this[ke](e)}},{key:t,value:function(e,t){this.emit("warn","unhandled websocket event '".concat(e,"':"),t)}}]),a}(n.n(je).a,W),_e=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).focused=!1,e.fullscreen=!1,e.activeKeys=new Set,e.controlling=!1,e.scroll=1,e.scroll_invert=!0,e.width=1280,e.height=720,e.rate=30,e.keepAliveInterval=0,e._container=d.a.createRef(),e._overlay=d.a.createRef(),e._video=d.a.createRef(),e.$client=new Ve,e.takeControl=function(){e.$client.connected?e.$client.sendMessage(Be.CONTROL):e.$client.once(Oe,(function(){e.$client.sendMessage(Be.CONTROL)}))},e.changeResolution=function(t){var n=t.split(/x|@/),a=Number(n[0]),i=Number(n[1]),r=Number(n[2]);e.$client.sendMessage(De.SET,{width:a,height:i,rate:r})},e.onFocus=Object(r.a)(i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.props.controlling||!navigator.clipboard||"function"!==typeof navigator.clipboard.readText){t.next=5;break}return t.next=3,navigator.clipboard.readText();case 3:n=t.sent,e.$client.sendMessage(Re.CLIPBOARD,{text:n});case 5:case"end":return t.stop()}}),t)}))),e.onBlur=function(){e.focused&&e.controlling&&e.activeKeys.forEach((function(t){e.$client.sendData("keyup",{key:t}),e.activeKeys.delete(t)}))},e.onClick=function(e){e.stopPropagation(),e.preventDefault()},e.onContextMenu=function(e){e.stopPropagation(),e.preventDefault()},e.onMousePos=function(t){var n={w:e.width,h:e.height},a=n.w,i=n.h,r=e._overlay.current.getBoundingClientRect();e.$client.sendData("mousemove",{x:Math.round(a/r.width*(t.clientX-r.left)),y:Math.round(i/r.height*(t.clientY-r.top))})},e.onWheel=function(t){if(t.stopPropagation(),t.preventDefault(),e.controlling){e.onMousePos(t);var n=t.deltaX,a=t.deltaY;e.scroll_invert&&(n*=-1,a*=-1),n=Math.min(Math.max(n,-e.scroll),e.scroll),a=Math.min(Math.max(a,-e.scroll),e.scroll),e.$client.sendData("wheel",{x:n,y:a})}},e.onMouseDown=function(t){t.stopPropagation(),t.preventDefault(),e.controlling&&(e.onMousePos(t),e.$client.sendData("mousedown",{key:t.button}))},e.onMouseUp=function(t){t.stopPropagation(),t.preventDefault(),e.controlling&&(e.onMousePos(t),e.$client.sendData("mouseup",{key:t.button}))},e.onMouseMove=function(t){e.controlling&&e.onMousePos(t)},e.onMouseEnter=function(t){e.controlling&&(e._overlay.current.focus(),e.onFocus(),e.focused=!0)},e.onMouseLeave=function(t){e.controlling&&(e._overlay.current.blur(),e.focused=!1)},e.getCode=function(e){var t=e.keyCode;return 59!==t||";"!==e.key&&":"!==e.key||(t=186),61!==t||"="!==e.key&&"+"!==e.key||(t=187),173!==t||"-"!==e.key&&"_"!==e.key||(t=189),t},e.onKeyDown=function(t){if(t.stopPropagation(),t.preventDefault(),e.focused&&e.controlling){var n=e.getCode(t);e.$client.sendData("keydown",{key:n}),e.activeKeys.add(n)}},e.onKeyUp=function(t){if(t.stopPropagation(),t.preventDefault(),e.focused&&e.controlling){var n=e.getCode(t);e.$client.sendData("keyup",{key:n}),e.activeKeys.delete(n)}},e.onResize=function(){},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e,t=this;this.controlling=this.props.controlling,this.keepAliveInterval=window.setInterval((function(){return t.$client.sendMessage("ka")}),1e4),this.$client.on(Oe,(function(){t.props.controlling&&t.takeControl()})),this.$client.on(ke,(function(){t.$client.login(n,t.props.password,t.props.username)})),this.$client.on(De.RESOLUTION,(function(e){t.width=e.width,t.height=e.height,t.rate=e.rate,t.props.setResolution("".concat(t.width,"x").concat(t.height,"@").concat(t.rate))})),this.$client.on(Se,(function(e,n){var a=document.getElementById("leftVideo");if(a.src="",a.srcObject=n,1===n.getTracks().length&&"audio"===e.kind){var i=document.getElementById("iPhoneAudio");i.srcObject=new MediaStream([e]),i.play()}t.props.doPlay()})),this.$client.on(Re.CLIPBOARD,this.onClipboardChanged);var n="wss://"+this.props.hostname+"/";this.$client.login(n,this.props.password,this.props.username),document.addEventListener("focusin",this.onFocus.bind(this)),document.addEventListener("focusout",this.onBlur.bind(this)),null===(e=document.getElementById("leftOverlay"))||void 0===e||e.addEventListener("wheel",this.onWheel,{passive:!1})}},{key:"componentDidUpdate",value:function(e){this.controlling=this.props.controlling,this.props.controlling&&!e.controlling&&this.takeControl(),this.props.resolution!==e.resolution&&this.changeResolution(this.props.resolution)}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.keepAliveInterval),this.$client.removeAllListeners(),this.$client.logout()}},{key:"onClipboardChanged",value:function(e){navigator.clipboard&&"function"===typeof navigator.clipboard.writeText&&navigator.clipboard.writeText(e)}},{key:"render",value:function(){var e,t;return Object($.jsx)("div",{id:"leftVideoParent",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:Object($.jsxs)("div",{ref:this._container,style:{width:"100%",height:"fit-content",position:"relative"},children:[Object($.jsx)("video",{playsInline:!0,ref:this._video,id:"leftVideo",style:{width:"100%"}}),Object($.jsx)("audio",{id:"iPhoneAudio"}),Object($.jsx)("div",{ref:this._overlay,id:"leftOverlay",tabIndex:0,style:{width:null===(e=document.getElementById("leftVideo"))||void 0===e?void 0:e.clientWidth,height:null===(t=document.getElementById("leftVideo"))||void 0===t?void 0:t.clientHeight,position:"absolute",top:0,bottom:0,scrollbarWidth:"none"},onClick:this.onClick,onContextMenu:this.onContextMenu,onMouseMove:this.onMouseMove,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp})]})})}}]),n}(d.a.Component),Ve=function(e,t,n,a,i,r,u,d,h,p,m,b,f){Object(c.a)(g,e);var j=Object(l.a)(g);function g(){return Object(s.a)(this,g),j.apply(this,arguments)}return Object(o.a)(g,[{key:"login",value:function(e,t,n){this.connect(e,t,n)}},{key:"logout",value:function(){this.disconnect()}},{key:t,value:function(){}},{key:n,value:function(){this.emit(Oe)}},{key:a,value:function(e){console.warn(e),this.emit(ke)}},{key:i,value:function(e){var t=e.track,n=e.streams;this.emit(Se,t,n[0])}},{key:r,value:function(e){console.log("[DATA]",e)}},{key:u,value:function(e){var t=e.message;this.onDisconnected(new Error(t))}},{key:d,value:function(e){e.id}},{key:h,value:function(e){e.id}},{key:p,value:function(e){e.id,e.target}},{key:m,value:function(e){var t=e.text;this.emit(Re.CLIPBOARD,t)}},{key:b,value:function(e){e.configurations}},{key:f,value:function(e){e.id;var t=e.width,n=e.height,a=e.rate;this.emit(De.RESOLUTION,{width:t,height:n,rate:a})}}]),g}(Ie,xe,Oe,ke,Se,Te,Me.DISCONNECT,Re.LOCKED,Re.RELEASE,Re.GIVE,Re.CLIPBOARD,De.CONFIGURATIONS,De.RESOLUTION),Ne=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).socket=e.props.socket,e.handleSignal=function(){var t=Object(r.a)(i.a.mark((function t(n){var a,r,s,o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.msg,r=n.from,s=window.watchparty.videoPCs[r],console.log("recv",r,n),void 0===a.ice){t.next=8;break}s.addIceCandidate(new RTCIceCandidate(a.ice)),t.next=20;break;case 8:if(!a.sdp||"offer"!==a.sdp.type){t.next=19;break}return t.next=11,s.setRemoteDescription(new RTCSessionDescription(a.sdp));case 11:return t.next=13,s.createAnswer();case 13:return o=t.sent,t.next=16,s.setLocalDescription(o);case 16:e.sendSignal(r,{sdp:s.localDescription}),t.next=20;break;case 19:a.sdp&&"answer"===a.sdp.type&&s.setRemoteDescription(new RTCSessionDescription(a.sdp));case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.setupWebRTC=Object(r.a)(i.a.mark((function t(){var n,a,r,s,o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.width,a=void 0===n?640:n,i=t.height,r=void 0===i?480:i,s=Object.assign(document.createElement("canvas"),{width:a,height:r});null===(e=s.getContext("2d"))||void 0===e||e.fillRect(0,0,a,r);var o=s.captureStream();return Object.assign(o.getVideoTracks()[0],{enabled:!1})},a=new MediaStream([n()]),t.prev=2,t.next=5,null===(r=navigator)||void 0===r?void 0:r.mediaDevices.getUserMedia({audio:!0,video:!0});case 5:a=t.sent,t.next=21;break;case 8:return t.prev=8,t.t0=t.catch(2),console.warn(t.t0),t.prev=11,console.log("attempt audio only stream"),t.next=15,null===(s=navigator)||void 0===s||null===(o=s.mediaDevices)||void 0===o?void 0:o.getUserMedia({audio:!0,video:!1});case 15:a=t.sent,t.next=21;break;case 18:t.prev=18,t.t1=t.catch(11),console.warn(t.t1);case 21:window.watchparty.ourStream=a,e.socket.emit("CMD:joinVideo");case 23:case"end":return t.stop()}}),t,null,[[2,8],[11,18]])}))),e.stopWebRTC=function(){var t=window.watchparty.ourStream,n=window.watchparty.videoPCs;t&&t.getTracks().forEach((function(e){e.stop()})),window.watchparty.ourStream=void 0,Object.keys(n).forEach((function(e){n[e].close(),delete n[e]})),e.socket.emit("CMD:leaveVideo")},e.toggleVideoWebRTC=function(){var t,n=window.watchparty.ourStream;n&&n.getVideoTracks()[0]&&(n.getVideoTracks()[0].enabled=!(null===(t=n.getVideoTracks()[0])||void 0===t?void 0:t.enabled));e.forceUpdate()},e.getVideoWebRTC=function(){var e,t=window.watchparty.ourStream;return t&&(null===(e=t.getVideoTracks()[0])||void 0===e?void 0:e.enabled)},e.toggleAudioWebRTC=function(){var t,n=window.watchparty.ourStream;n&&n.getAudioTracks()[0]&&(n.getAudioTracks()[0].enabled=!(null===(t=n.getAudioTracks()[0])||void 0===t?void 0:t.enabled));e.forceUpdate()},e.getAudioWebRTC=function(){var e=window.watchparty.ourStream;return e&&e.getAudioTracks()[0]&&e.getAudioTracks()[0].enabled},e.updateWebRTC=function(){var t=window.watchparty.ourStream,n=window.watchparty.videoPCs,a=window.watchparty.videoRefs;t&&e.props.participants.forEach((function(s){var o=s.id;if(!s.isVideoChat&&n[o]&&(n[o].close(),delete n[o]),s.isVideoChat&&!n[o])if(o===e.socket.id)n[o]=new RTCPeerConnection,a[o].srcObject=t;else{var c=new RTCPeerConnection({iceServers:Object(z.p)()});n[o]=c,null===t||void 0===t||t.getTracks().forEach((function(e){t&&c.addTrack(e,t)})),c.onicecandidate=function(t){t.candidate&&e.sendSignal(o,{ice:t.candidate})},c.ontrack=function(e){a[o].srcObject=e.streams[0]},e.socket.id<o&&(c.onnegotiationneeded=Object(r.a)(i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.createOffer();case 2:return n=t.sent,t.next=5,c.setLocalDescription(n);case 5:e.sendSignal(o,{sdp:c.localDescription});case 6:case"end":return t.stop()}}),t)}))))}}))},e.sendSignal=function(){var t=Object(r.a)(i.a.mark((function t(n,a){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("send",n,a),e.socket.emit("signal",{to:n,msg:a});case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.socket.on("signal",this.handleSignal)}},{key:"componentWillUnmount",value:function(){this.socket.off("signal",this.handleSignal)}},{key:"componentDidUpdate",value:function(e){this.props.rosterUpdateTS!==e.rosterUpdateTS&&this.updateWebRTC()}},{key:"render",value:function(){var e=this.props,t=e.participants,n=e.pictureMap,a=e.nameMap,i=e.tsMap,r=e.socket,s=e.owner,o=e.user,c=window.watchparty.ourStream,l=window.watchparty.videoRefs,u={height:t.length<3?220:110,borderRadius:"4px",objectFit:"contain"};return Object($.jsxs)("div",{style:{display:this.props.hide?"none":"flex",width:"100%",flexDirection:"column",overflow:"auto"},children:[!c&&Object($.jsx)("div",{style:{display:"flex",flexWrap:"wrap",marginTop:"8px"},children:Object($.jsxs)(R.a,{fluid:!0,title:"Join Video Chat",color:"purple",size:"medium",icon:!0,labelPosition:"left",onClick:this.setupWebRTC,children:[Object($.jsx)(C.a,{name:"video"}),"Join Video Chat"]})}),c&&Object($.jsxs)("div",{style:{display:"flex",flexWrap:"wrap"},children:[Object($.jsxs)(R.a,{fluid:!0,color:"red",size:"medium",icon:!0,labelPosition:"left",onClick:this.stopWebRTC,children:[Object($.jsx)(C.a,{name:"external"}),"Leave Video Chat"]}),Object($.jsxs)("div",{style:{display:"flex",justifyContent:"center",marginTop:"8px",width:"100%"},children:[Object($.jsxs)(R.a,{color:this.getVideoWebRTC()?"green":"red",fluid:!0,size:"medium",icon:!0,labelPosition:"left",onClick:this.toggleVideoWebRTC,children:[Object($.jsx)(C.a,{name:"video"}),this.getVideoWebRTC()?"On":"Off"]}),Object($.jsxs)(R.a,{color:this.getAudioWebRTC()?"green":"red",fluid:!0,size:"medium",icon:!0,labelPosition:"left",onClick:this.toggleAudioWebRTC,children:[Object($.jsx)(C.a,{name:this.getAudioWebRTC()?"microphone":"microphone slash"}),this.getAudioWebRTC()?"On":"Off"]})]})]}),Object($.jsx)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",marginTop:"8px"},children:t.map((function(e){return Object($.jsx)("div",{children:Object($.jsx)("div",{style:{position:"relative"},children:Object($.jsxs)("div",{children:[Object($.jsx)(J,{displayName:a[e.id]||e.id,user:o,disabled:!Boolean(s&&s===(null===o||void 0===o?void 0:o.uid)),position:"left center",socket:r,userToManage:e.id,trigger:Object($.jsx)(C.a,{name:"ellipsis vertical",size:"large",style:{position:"absolute",right:-7,top:5,cursor:"pointer",opacity:.75,visibility:Boolean(s&&s===(null===o||void 0===o?void 0:o.uid))?"visible":"hidden"}})}),c&&e.isVideoChat?Object($.jsx)("video",{ref:function(t){t&&(l[e.id]=t)},style:Object(j.a)(Object(j.a)({},u),{},{transform:"scaleX(".concat(e.id===r.id?"-1":"1",")")}),autoPlay:!0,muted:e.id===r.id,"data-id":e.id}):Object($.jsx)("img",{style:u,src:n[e.id]||Object(z.j)(a[e.id],Object(z.i)(e.id)),alt:""}),Object($.jsxs)("div",{style:{position:"absolute",bottom:"4px",left:"0px",width:"100%",backgroundColor:"rgba(0,0,0,0)",color:"white",borderRadius:"4px",fontSize:"10px",fontWeight:700,display:"flex"},children:[Object($.jsxs)("div",{title:a[e.id]||e.id,style:{width:"80px",backdropFilter:"brightness(80%)",padding:"4px",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",display:"inline-block"},children:[e.isVideoChat&&Object($.jsx)(C.a,{size:"small",name:"video"}),a[e.id]||e.id]}),Object($.jsx)("div",{style:{backdropFilter:"brightness(60%)",padding:"4px",flexGrow:1,display:"flex",justifyContent:"center"},children:Object(z.f)(i[e.id]||0)})]})]})})},e.id)}))})]})}}]),n}(d.a.Component);n(397);function Ae(){var e=window.localStorage.getItem("watchparty-setting");try{var t=Le(e);return t||{}}catch(n){return console.warn(n),{}}}function Le(e){var t=JSON.parse(e);if(!e)return{};if("{"!==e[0])throw new Error("failed to parse settings, using defaults");return t}function ze(e){window.localStorage.setItem("watchparty-setting",e)}var Fe=n(408),Ue=function(e){var t=e.streams,n=e.setMedia,a=e.resetMultiSelect;return Object($.jsxs)(P.a,{inverted:!0,basic:!0,open:!0,closeIcon:!0,onClose:a,children:[Object($.jsx)(P.a.Header,{children:"Select a file"}),Object($.jsxs)(P.a.Content,{children:[0===t.length&&Object($.jsx)(_.a,{}),t&&Object($.jsx)(Fe.a,{inverted:!0,children:t.map((function(e){return Object($.jsxs)(Fe.a.Item,{children:[Object($.jsx)(Fe.a.Icon,{name:"file"}),Object($.jsxs)(Fe.a.Content,{children:[Object($.jsx)(Fe.a.Header,{as:"a",onClick:function(){n(null,{value:e.url}),a()},children:e.name}),Object($.jsxs)(Fe.a.Description,{children:[e.length.toLocaleString()," bytes"]})]})]})}))})]})]})},Ye=["https://upload.wikimedia.org/wikipedia/commons/a/a5/Spring_-_Blender_Open_Movie.webm","https://upload.wikimedia.org/wikipedia/commons/8/88/Big_Buck_Bunny_alt.webm","https://upload.wikimedia.org/wikipedia/commons/7/75/Sintel_movie_720x306.ogv","https://upload.wikimedia.org/wikipedia/commons/c/cb/Tears_of_Steel_1080p.webm","https://upload.wikimedia.org/wikipedia/commons/3/36/Cosmos_Laundromat_-_First_Cycle_-_Official_Blender_Foundation_release.webm","https://upload.wikimedia.org/wikipedia/commons/a/a2/Elephants_Dream_%282006%29.webm","https://upload.wikimedia.org/wikipedia/commons/a/a9/HERO_-_Blender_Open_Movie-full_movie.webm","https://upload.wikimedia.org/wikipedia/commons/0/02/Glass_Half_-_Blender_Open_Movie-full_movie.webm","https://upload.wikimedia.org/wikipedia/commons/d/d0/Caminandes-_Llama_Drama_-_Short_Movie.ogv"].map((function(e){return{url:e,type:"file",name:e,duration:0}})),We=n(265),He=n(73),qe=n.n(He),Ke=function(e){var t=e.video,n=e.index,a=e.controls,i=e.onPlay,r=e.onPlayNext,s=e.onRemove,o=e.onSetMedia,c=e.disabled,l=e.onPlaylistAdd,u=e.isYoutube,h=d.a.useCallback((function(e){i&&i(n)}),[i,n]),p=d.a.useCallback((function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),r&&r(n)}),[r,n]),m=d.a.useCallback((function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),s&&s(n)}),[s,n]);return Object($.jsx)("div",{title:t.name,className:qe.a.Card,onClick:o?function(e){o(e,{value:t.url})}:void 0,children:Object($.jsxs)("div",{className:qe.a.Wrapper,children:[Object($.jsxs)("div",{className:qe.a.ThumbnailWrapper,children:[!!t.duration&&Object($.jsx)("div",{className:qe.a.DurationLabel,children:Object(z.f)(t.duration)}),!!t.img&&Object($.jsx)("img",{className:qe.a.Thumbnail,src:t.img,alt:t.name})]}),Object($.jsx)(C.a,{color:u?"red":"black",size:"large",name:u?"youtube":"linkify"}),Object($.jsxs)("div",{className:qe.a.Content,children:[Object($.jsx)("div",{className:qe.a.Title,children:Object(z.d)(t.name)}),Object($.jsx)("div",{className:qe.a.ChannelName,children:t.channel})]}),l&&Object($.jsx)("div",{className:qe.a.Controls,children:Object($.jsx)("div",{style:{marginLeft:"auto"},children:Object($.jsx)(R.a,{className:"playlistAddButton",onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),l(e,{value:t.url})},children:"Add To Playlist"})})}),a&&Object($.jsx)("div",{className:qe.a.Controls,children:Object($.jsxs)(We.a,{size:"mini",children:[Object($.jsx)(R.a,{icon:!0,color:"green",title:"Play now",onClick:h,disabled:c,children:Object($.jsx)(C.a,{name:"play"})}),Object($.jsx)(R.a,{icon:!0,color:"black",title:"Play next",onClick:p,disabled:c,children:Object($.jsx)(C.a,{name:"arrow up"})}),Object($.jsx)(R.a,{icon:!0,color:"red",title:"Remove",onClick:m,disabled:c,children:Object($.jsx)(C.a,{name:"trash"})})]})})]})})},Ge=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={inputMedia:void 0,results:void 0,loading:!1,lastResultTimestamp:Number(new Date)},e.debounced=null,e.setMediaAndClose=function(t,n){window.setTimeout((function(){return e.setState({inputMedia:void 0,results:void 0})}),300),e.props.setMedia(t,n)},e.doSearch=function(){var t=Object(r.a)(i.a.mark((function t(n){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.persist(),e.setState({inputMedia:n.target.value},(function(){e.debounced||(e.debounced=Object(z.c)(Object(r.a)(i.a.mark((function t(){var n,a,r,s,o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setState({loading:!0}),n=e.state.inputMedia||"",a=Number(new Date),r=void 0,!(""===n||n&&n.startsWith("http"))){t.next=10;break}s=Ye,n&&(s=[{name:n,type:"file",url:n,duration:0}]),r=s.map((function(t,n){return Object($.jsx)(T.a.Item,{onClick:function(n){return e.setMediaAndClose(n,{value:t.url})},children:Object($.jsx)(Ke,{video:t,index:n,onPlaylistAdd:e.props.playlistAdd})},t.url)})),t.next=14;break;case 10:return t.next=12,Object(z.o)(n);case 12:o=t.sent,r=o.map((function(t,n){return Object($.jsx)(T.a.Item,{onClick:function(n){return e.setMediaAndClose(n,{value:t.url})},children:Object($.jsx)(Ke,{video:t,index:n,onPlaylistAdd:e.props.playlistAdd,isYoutube:!0})},t.url)}));case 14:a>e.state.lastResultTimestamp&&e.setState({loading:!1,results:r,lastResultTimestamp:a});case 15:case"end":return t.stop()}}),t)}))),500)),e.debounced()}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(o.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.currentMedia,a=t.getMediaDisplayName,i=this.state.results;return Object($.jsxs)("div",{style:{position:"relative"},children:[Object($.jsxs)("div",{style:{display:"flex",gap:"4px"},children:[Object($.jsx)(S.a,{style:{flexGrow:1},inverted:!0,fluid:!0,focus:!0,disabled:this.props.disabled,onChange:this.doSearch,onFocus:function(t){t.persist(),e.setState({inputMedia:a(n)},(function(){(!e.state.inputMedia||e.state.inputMedia&&e.state.inputMedia.startsWith("http"))&&e.doSearch(t)})),setTimeout((function(){return t.target.select()}),100)},onBlur:function(){setTimeout((function(){return e.setState({inputMedia:void 0,results:void 0})}),100)},onKeyPress:function(t){"Enter"===t.key&&e.setMediaAndClose(t,{value:e.state.inputMedia})},icon:Object($.jsx)(C.a,{onClick:function(t){return e.setMediaAndClose(t,{value:e.state.inputMedia})},name:"arrow right",link:!0,circular:!0}),loading:this.state.loading,label:"Now Watching:",placeholder:"Enter video file URL, YouTube link, or YouTube search term",value:void 0!==this.state.inputMedia?this.state.inputMedia:a(n)}),Object($.jsx)(E.a,{icon:"list",labeled:!0,className:"icon",button:!0,text:"Playlist (".concat(this.props.playlist.length,")"),scrolling:!0,children:Object($.jsxs)(E.a.Menu,{direction:"left",children:[0===this.props.playlist.length&&Object($.jsx)(E.a.Item,{disabled:!0,children:"There are no items in the playlist."}),this.props.playlist.map((function(t,n){return Object($.jsx)(E.a.Item,{children:Object($.jsx)("div",{style:{maxWidth:"500px"},children:Object($.jsx)(Ke,{video:t,index:n,controls:!0,onPlay:function(t){var n;e.props.setMedia(null,{value:null===(n=e.props.playlist[t])||void 0===n?void 0:n.url}),e.props.playlistDelete(t)},onPlayNext:function(t){e.props.playlistMove(t,0)},onRemove:function(t){e.props.playlistDelete(t)},disabled:e.props.disabled,isYoutube:Boolean(t.img)})})})}))]})})]}),Boolean(i)&&void 0!==this.state.inputMedia&&Object($.jsx)(T.a,{fluid:!0,vertical:!0,style:{position:"absolute",top:"22px",maxHeight:"250px",overflow:"scroll",zIndex:1001},children:i})]})}}]),n}(d.a.Component),$e=function(e){var t=e,n=e.setMedia;return Object($.jsx)(T.a.Item,{onClick:function(e){n(e,{value:t.url})},children:Object($.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[Object($.jsx)("img",{style:{height:"50px"},src:t.img,alt:t.name}),Object($.jsx)(C.a,{color:"red",size:"large",name:"youtube"}),Object($.jsx)("div",{children:Object(z.d)(t.name)}),Object($.jsx)("div",{style:{marginLeft:"auto"},children:Object($.jsx)(R.a,{onClick:function(n){n.stopPropagation(),n.nativeEvent.stopImmediatePropagation(),e.playlistAdd(n,{value:t.url})},children:"Add To Playlist"})})]})})},Je=function(e){var t=e,n=e.setMedia;return Object($.jsx)(T.a.Item,{onClick:function(e){n(e,{value:t.url})},children:Object($.jsxs)("div",{style:{display:"flex"},children:[Object($.jsx)(C.a,{name:"file"}),t.name]})})},Xe=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=this.props.setMedia;return Object($.jsx)(d.a.Fragment,{children:Object($.jsxs)(T.a.Item,{onClick:function(){var a=Object(r.a)(i.a.mark((function a(r){var s,o,c;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.props.launchMultiSelect([]),a.next=3,window.fetch(e.props.streamPath+"/data?torrent="+encodeURIComponent(t.magnet));case 3:return s=a.sent,a.next=6,s.json();case 6:(o=a.sent).files.filter((function(e){return e.length>10485760})).length>1?((c=o.files.map((function(n,a){return Object(j.a)(Object(j.a)({},n),{},{url:e.props.streamPath+"/stream?torrent="+encodeURIComponent(t.magnet)+"&fileIndex="+a})}))).sort((function(e,t){return e.name.localeCompare(t.name)})),e.props.launchMultiSelect(c)):(e.props.launchMultiSelect(void 0),n(r,{value:e.props.streamPath+"/stream?torrent="+encodeURIComponent(t.magnet)}));case 8:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),children:[Object($.jsx)(M.a,{circular:!0,empty:!0,color:Number(t.seeders)?"green":"red"}),Object($.jsx)(C.a,{name:"film"}),t.name+" - "+t.size+" - "+t.seeders+" peers"]})})}}]),n}(d.a.Component),Qe=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={results:[],resetDropdown:Number(new Date),loading:!1,lastResultTimestamp:Number(new Date),inputMedia:void 0},e.debounced=null,e.doSearch=function(){var t=Object(r.a)(i.a.mark((function t(n){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.persist(),e.setState({inputMedia:n.target.value},(function(){e.debounced||(e.debounced=Object(z.c)(Object(r.a)(i.a.mark((function t(){var n,a,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setState({loading:!0}),n=e.state.inputMedia||"",a=[],r=Number(new Date),"youtube"!==e.props.type){t.next=10;break}return t.next=7,Object(z.o)(n);case 7:a=t.sent,t.next=20;break;case 10:if("media"!==e.props.type||!e.props.mediaPath){t.next=16;break}return t.next=13,Object(z.k)(e.props.mediaPath,n);case 13:a=t.sent,t.next=20;break;case 16:if("stream"!==e.props.type||!e.props.streamPath){t.next=20;break}return t.next=19,Object(z.m)(e.props.streamPath,n);case 19:a=t.sent;case 20:r>e.state.lastResultTimestamp&&e.setState({loading:!1,results:a,lastResultTimestamp:r});case 21:case"end":return t.stop()}}),t)}))),500)),e.debounced()}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.setMedia=function(t,n){window.setTimeout((function(){return e.setState({resetDropdown:Number(new Date)})}),300),e.props.setMedia(t,n)},e}return Object(o.a)(n,[{key:"render",value:function(){var e=this,t=this.setMedia,n="Search streams",a="film";return"youtube"===this.props.type?(n="Search YouTube",a="youtube"):"media"===this.props.type&&(n=this.props.mediaPath||"",a="file"),this.state.loading&&(a="loading circle notch"),Object($.jsx)(d.a.Fragment,{children:Object($.jsx)(E.a,{fluid:!0,style:{height:"36px"},button:!0,icon:a,className:"icon",labeled:!0,disabled:this.props.disabled,search:function(){},text:n,onSearchChange:this.doSearch,onFocus:function(){var t=Object(r.a)(i.a.mark((function t(n){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"media"===e.props.type&&e.props.mediaPath&&e.doSearch(n);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),scrolling:!0,children:Boolean(this.state.results.length)?Object($.jsx)(E.a.Menu,{children:this.state.results.map((function(n){return"youtube"===e.props.type?Object($.jsx)($e,Object(j.a)(Object(j.a)({},n),{},{setMedia:t,playlistAdd:e.props.playlistAdd}),n.url):"media"===e.props.type?Object($.jsx)(Je,Object(j.a)(Object(j.a)({},n),{},{setMedia:t}),n.url):Object($.jsx)(Xe,Object(j.a)(Object(j.a)({},n),{},{setMedia:t,launchMultiSelect:e.props.launchMultiSelect,streamPath:e.props.streamPath||""}),n.url)}))}):null},this.state.resetDropdown)})}}]),n}(d.a.Component),Ze=n(267),et=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={showTimestamp:!1,currTimestamp:0,posTimestamp:0,volume:1,muted:e.props.muted},e.onMouseOver=function(){e.setState({showTimestamp:!0})},e.onMouseOut=function(){e.setState({showTimestamp:!1})},e.onMouseMove=function(t){var n=t.target.getBoundingClientRect(),a=(t.clientX-n.left)/n.width,i=a*e.props.duration;a>=0&&e.setState({currTimestamp:i,posTimestamp:a})},e}return Object(o.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.togglePlay,a=t.onSeek,i=t.fullScreen,r=t.toggleMute,s=t.toggleSubtitle,o=t.jumpToLeader,c=t.currentTime,l=t.duration,u=t.leaderTime,d=t.isPauseDisabled,h=t.disabled,p=t.subtitled,m=t.paused,b=this.state,f=b.muted,j=b.volume,g=u&&u-c>5;return Object($.jsxs)("div",{className:"controls",children:[Object($.jsx)(C.a,{size:"large",onClick:function(){n()},className:"control action",disabled:h||d,name:m?"play":"pause"}),Object($.jsx)(B.a,{content:(g?"We've detected that your stream is behind. ":"")+"Click to sync to leader.",trigger:Object($.jsx)(C.a,{size:"large",onClick:o,className:"control action ".concat(g?"glowing":""),name:"angle double right"})}),Object($.jsx)("div",{className:"control",children:Object(z.f)(c)}),Object($.jsx)(V.a,{size:"tiny",color:"blue",onClick:l<1/0&&!this.props.disabled?a:void 0,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,onMouseMove:this.onMouseMove,className:"control action",inverted:!0,style:{flexGrow:1,marginTop:0,marginBottom:0,position:"relative",minWidth:"50px"},value:c,total:l,children:l<1/0&&this.state.showTimestamp&&Object($.jsx)("div",{style:{position:"absolute",bottom:"0px",left:"calc(".concat(100*this.state.posTimestamp+"% - 27px",")"),pointerEvents:"none"},children:Object($.jsx)(M.a,{basic:!0,color:"blue",pointing:"below",children:Object($.jsx)("div",{style:{width:"34px"},children:Object(z.f)(this.state.currTimestamp)})})})}),Object($.jsx)("div",{className:"control",children:Object(z.f)(l)}),Object($.jsx)(C.a,{size:"large",onClick:function(){s()},className:"control action",name:p?"closed captioning":"closed captioning outline",title:"Captions"}),Object($.jsx)(C.a,{size:"large",onClick:function(){return i(!1)},className:"control action",style:{transform:"rotate(90deg)"},name:"window maximize outline",title:"Theater Mode"}),Object($.jsx)(C.a,{size:"large",onClick:function(){return i(!0)},className:"control action",name:"expand",title:"Fullscreen"}),Object($.jsx)(C.a,{size:"large",onClick:function(){r(),e.setState({muted:!e.state.muted})},className:"control action",name:f?"volume off":"volume up",title:"Mute"}),Object($.jsx)("div",{style:{width:"100px",marginRight:"10px"},children:Object($.jsx)(Ze.Slider,{value:j,color:"blue",settings:{min:0,max:1,step:.01,onChange:function(t){e.setState({volume:t}),e.props.setVolume(t)}}})})]})}}]),n}(d.a.Component),tt=n(218),nt=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={isVMPoolFull:!1},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=Object(r.a)(i.a.mark((function e(){var t,n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(z.s+"/metadata");case 2:return n=e.sent,e.next=5,n.json();case 5:a=e.sent,(null===(t=a.isVMPoolFull)||void 0===t?void 0:t.US)&&this.setState({isVMPoolFull:!0});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.closeModal,n=e.startVBrowser,a=Object(tt.b)((function(e){var a=e.googleReCaptchaProps,s=e.large;return Object($.jsx)(R.a,{size:"large",color:s?"orange":void 0,onClick:Object(r.a)(i.a.mark((function e(){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.executeRecaptcha("launchVBrowser");case 2:r=e.sent,n(r,{size:s?"large":""}),t();case 5:case"end":return e.stop()}}),e)}))),children:s?"Launch VBrowser+":"Continue with Free"})})),s=Object($.jsx)(D.a,{size:"small",color:"red",icon:"hourglass two",style:{width:"380px"},header:"No Free VBrowsers Available",content:Object($.jsxs)("div",{children:[Object($.jsx)("div",{children:"All of the free VBrowsers are currently being used."}),Object($.jsx)("div",{children:"Please consider subscribing for anytime access to faster VBrowsers, or try again later."})]})});return Object($.jsx)(tt.a,{reCaptchaKey:"6LeDGP4UAAAAAGYZZenyU-3fRdhL3p0BaBmiK9mM",useRecaptchaNet:!0,children:Object($.jsxs)(P.a,{open:!0,onClose:t,children:[Object($.jsx)(P.a.Header,{children:"Launch a VBrowser"}),Object($.jsx)(P.a.Content,{image:!0,children:Object($.jsxs)(P.a.Description,{children:[Object($.jsx)("div",{children:"You're about to launch a virtual browser to share in this room."}),Object($.jsxs)(se.a,{definition:!0,unstackable:!0,striped:!0,celled:!0,children:[Object($.jsx)(se.a.Header,{children:Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.HeaderCell,{}),Object($.jsx)(se.a.HeaderCell,{children:"WatchParty Free"}),Object($.jsx)(se.a.HeaderCell,{children:"WatchParty Plus"})]})}),Object($.jsxs)(se.a.Body,{children:[Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"VBrowser Resolution"}),Object($.jsx)(se.a.Cell,{children:"720p"}),Object($.jsx)(se.a.Cell,{children:"1080p"})]}),Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"VBrowser CPU/RAM"}),Object($.jsx)(se.a.Cell,{children:"Standard"}),Object($.jsx)(se.a.Cell,{children:"Extra"})]}),Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"VBrowser Session Length"}),Object($.jsx)(se.a.Cell,{children:"3 hours"}),Object($.jsx)(se.a.Cell,{children:"24 hours"})]}),Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{}),Object($.jsx)(se.a.Cell,{children:this.props.user?this.state.isVMPoolFull?s:Object($.jsx)(a,{}):Object($.jsx)(pe,{fluid:!0,user:this.props.user})}),Object($.jsx)(se.a.Cell,{children:this.props.isSubscriber?Object($.jsx)(a,{large:!0}):this.props.subscribeButton})]})]})]})]})})]})})}}]),n}(d.a.Component),at=n(399),it=n(396),rt=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props.closeModal;return Object($.jsxs)(P.a,{open:!0,onClose:e,closeIcon:!0,children:[Object($.jsx)(P.a.Header,{children:"Permanent Rooms"}),Object($.jsx)(P.a.Content,{image:!0,children:Object($.jsxs)(P.a.Description,{children:[Object($.jsx)("div",{children:"Registered users have the ability to make their rooms permanent. Subscribed users can create multiple permanent rooms."}),Object($.jsxs)(se.a,{definition:!0,unstackable:!0,striped:!0,celled:!0,children:[Object($.jsx)(se.a.Header,{children:Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.HeaderCell,{}),Object($.jsx)(se.a.HeaderCell,{children:"Temporary"}),Object($.jsx)(se.a.HeaderCell,{children:"Permanent"})]})}),Object($.jsxs)(se.a.Body,{children:[Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"Expiry"}),Object($.jsx)(se.a.Cell,{children:"After 24 hours of inactivity"}),Object($.jsx)(se.a.Cell,{children:"Never"})]}),Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"Room Passwords"}),Object($.jsx)(se.a.Cell,{}),Object($.jsx)(se.a.Cell,{children:Object($.jsx)(C.a,{name:"check"})})]}),Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"Disable Chat"}),Object($.jsx)(se.a.Cell,{}),Object($.jsx)(se.a.Cell,{children:Object($.jsx)(C.a,{name:"check"})})]}),Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"Kick Users"}),Object($.jsx)(se.a.Cell,{}),Object($.jsx)(se.a.Cell,{children:Object($.jsx)(C.a,{name:"check"})})]}),Object($.jsxs)(se.a.Row,{children:[Object($.jsx)(se.a.Cell,{children:"Custom Room URLs (subscribers)"}),Object($.jsx)(se.a.Cell,{}),Object($.jsx)(se.a.Cell,{children:Object($.jsx)(C.a,{name:"check"})})]})]})]})]})})]})}}]),n}(d.a.Component),st=function(e){var t=e.hide,n=e.user,a=e.roomLock,s=e.setRoomLock,o=e.socket,c=e.isSubscriber,l=e.owner,h=e.vanity,p=e.setVanity,m=e.roomLink,b=e.password,f=e.setPassword,g=e.isChatDisabled,v=e.setIsChatDisabled,y=e.clearChat,x=Object(u.useState)(0),O=Object(G.a)(x,2),k=O[0],T=O[1],P=Object(u.useState)(!1),B=Object(G.a)(P,2),E=B[0],I=B[1],_=Object(u.useState)(!0),V=Object(G.a)(_,2),N=V[0],A=V[1],L=Object(u.useState)(!1),F=Object(G.a)(L,2),U=F[0],Y=F[1],W=Object(u.useState)(!1),H=Object(G.a)(W,2),q=H[0],K=H[1],J=Object(u.useCallback)(function(){var e=Object(r.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===n||void 0===n?void 0:n.getIdToken();case 2:a=e.sent,o.emit("CMD:setRoomState",Object(j.a)({uid:null===n||void 0===n?void 0:n.uid,token:a},t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o,n]),X=Object(u.useCallback)(function(){var e=Object(r.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===n||void 0===n?void 0:n.getIdToken();case 2:a=e.sent,o.emit("CMD:setRoomOwner",Object(j.a)({uid:null===n||void 0===n?void 0:n.uid,token:a},t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o,n]),Q=Object(u.useCallback)(function(){var e=Object(r.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return A(!0),e.abrupt("return");case 3:return A(!1),Y(!0),e.next=7,w.a.get(z.s+"/resolveRoom/"+t);case 7:n=e.sent,a=n.data,Y(!1),a&&a.vanity&&a.vanity!==m.split("/").slice(-1)[0]?A(!1):A(!0);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[A,m]),Z=!Boolean(n)||Boolean(a&&a!==(null===n||void 0===n?void 0:n.uid)),ee=!Boolean(n)||Boolean(l&&l!==(null===n||void 0===n?void 0:n.uid));return Object($.jsxs)("div",{style:{display:t?"none":"block",color:"white",overflow:"scroll",padding:"8px"},children:[E&&Object($.jsx)(rt,{closeModal:function(){return I(!1)}}),Object($.jsx)("div",{className:"sectionHeader",children:"Room Settings"}),!n&&Object($.jsx)(D.a,{color:"yellow",size:"tiny",children:"You need to be signed in to change these settings."}),Object($.jsx)(ot,{icon:a?"lock":"lock open",name:"Lock Room",description:"Only the person who locked the room can control the video.",checked:Boolean(a),disabled:Z,onChange:function(e,t){return s(t.checked)}}),Object($.jsx)(ot,{icon:"clock",name:"Make Room Permanent",description:"Prevent this room from expiring. This also unlocks additional room features.",helpIcon:Object($.jsx)(C.a,{name:"help circle",onClick:function(){return I(!0)},style:{cursor:"pointer"}}),checked:Boolean(l),disabled:ee,onChange:function(e,t){return X({undo:!t.checked})}}),l&&l===(null===n||void 0===n?void 0:n.uid)&&Object($.jsx)("div",{className:"sectionHeader",children:"Admin Settings"}),l&&l===(null===n||void 0===n?void 0:n.uid)&&Object($.jsx)(ot,{icon:"key",name:"Set Room Password",description:"Users must know this password in order to join the room.",content:Object($.jsx)(S.a,{value:b,size:"mini",onChange:function(e){K(!0),f(e.target.value)},fluid:!0}),disabled:!1}),l&&l===(null===n||void 0===n?void 0:n.uid)&&Object($.jsx)(ot,{icon:"i cursor",name:"Disable Chat",description:"Prevent users from sending messages in chat.",checked:Boolean(g),disabled:!1,onChange:function(e,t){K(!0),v(Boolean(t.checked))}}),l&&l===(null===n||void 0===n?void 0:n.uid)&&Object($.jsx)(ot,{icon:"i delete",name:"Clear Chat",description:"Delete all existing chat messages",disabled:!1,content:Object($.jsxs)(R.a,{color:"red",icon:!0,labelPosition:"left",onClick:function(){return y()},children:[Object($.jsx)(C.a,{name:"delete"}),"Delete Messages"]})}),l&&l===(null===n||void 0===n?void 0:n.uid)&&Object($.jsx)(ot,{icon:"linkify",name:"Set Custom Room URL",description:"Set a custom URL for this room. Inappropriate names may be revoked.",checked:Boolean(a),disabled:!c,subOnly:!0,content:Object($.jsx)(d.a.Fragment,{children:Object($.jsx)(S.a,{value:h,disabled:!c,onChange:function(e){K(!0),Q(e.target.value),p(e.target.value)},label:Object($.jsx)(M.a,{children:"".concat(window.location.origin,"/r/")}),loading:U,fluid:!0,size:"mini",icon:!0,action:N?Object($.jsx)(C.a,{name:"checkmark",color:"green"}):Object($.jsx)(C.a,{name:"close",color:"red"})})})}),Object($.jsx)("p",{}),l&&l===(null===n||void 0===n?void 0:n.uid)&&Object($.jsxs)(R.a,{primary:!0,disabled:!N||!q,labelPosition:"left",icon:!0,fluid:!0,onClick:function(){J({vanity:h,password:b,isChatDisabled:g}),K(!1)},children:[Object($.jsx)(C.a,{name:"save"}),"Save Admin Settings"]}),Object($.jsx)("div",{className:"sectionHeader",children:"Local Settings"}),Object($.jsx)(ot,{updateTS:k,icon:"bell",name:"Disable chat notification sound",description:"Don't play a sound when a chat message is sent while you're on another tab",checked:Boolean(Ae().disableChatSound),disabled:!1,onChange:function(e,t){ze(JSON.stringify(Object(j.a)(Object(j.a)({},Ae()),{},{disableChatSound:t.checked}))),T(Number(new Date))}})]})},ot=function(e){var t=e.icon,n=e.name,a=e.description,i=e.checked,r=e.disabled,s=e.onChange,o=e.content,c=e.subOnly,l=e.helpIcon;return Object($.jsxs)(d.a.Fragment,{children:[Object($.jsx)(at.a,{inverted:!0,horizontal:!0}),Object($.jsxs)("div",{children:[Object($.jsxs)("div",{style:{display:"flex"},children:[Object($.jsx)(C.a,{size:"large",name:t}),Object($.jsxs)("div",{children:[n," ",l,c?Object($.jsx)(M.a,{size:"mini",color:"orange",children:"Subscriber only"}):null]}),!o&&Object($.jsx)(it.a,{style:{marginLeft:"auto"},toggle:!0,checked:i,disabled:r,onChange:s})]}),Object($.jsx)("div",{className:"smallText",style:{marginBottom:"8px"},children:a}),o]})]})},ct=function(e){var t=e.error;return Object($.jsxs)(P.a,{inverted:!0,basic:!0,open:!0,children:[Object($.jsx)(re.a,{as:"h1",style:{textAlign:"center"},children:t}),Object($.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object($.jsxs)(R.a,{primary:!0,size:"huge",onClick:function(){window.location.href="/"},icon:!0,labelPosition:"left",children:[Object($.jsx)(C.a,{name:"home"}),"Go to home page"]})})]})},lt=n(6),ut=function(e){var t=e.savedPasswords,n=e.roomId,a=Object(u.useCallback)((function(){var e;window.localStorage.setItem("watchparty-passwords",JSON.stringify(Object(j.a)(Object(j.a)({},t),{},Object(lt.a)({},n,null===(e=document.getElementById("roomPassword"))||void 0===e?void 0:e.value)))),window.location.reload()}),[t,n]);return Object($.jsxs)(P.a,{inverted:!0,basic:!0,open:!0,children:[Object($.jsx)(re.a,{as:"h1",style:{textAlign:"center"},children:"This room requires a password."}),Object($.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object($.jsx)(S.a,{id:"roomPassword",type:"password",size:"large",onKeyPress:function(e){return"Enter"===e.key&&a()},icon:Object($.jsx)(C.a,{onClick:a,name:"key",inverted:!0,circular:!0,link:!0})})})]})},dt=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this,t=this.props.closeModal;return Object($.jsxs)(P.a,{open:!0,onClose:t,children:[Object($.jsx)(P.a.Header,{children:"Share Your Screen"}),Object($.jsx)(P.a.Content,{image:!0,children:Object($.jsxs)(P.a.Description,{children:[Object($.jsx)("div",{children:"You're about to share your screen."}),Object($.jsxs)("ul",{children:[Object($.jsx)("li",{children:"This feature is only supported on Chrome and Edge."}),Object($.jsx)("li",{children:'To share audio, you need to check the "Share audio" checkbox in the screen selection dialog.'}),Object($.jsx)("li",{children:"Audio sharing is only supported if sharing your entire screen or a browser tab, not an application."})]}),Object($.jsx)(R.a,{onClick:function(){e.props.startScreenShare(),e.props.closeModal()},children:"Start Screenshare"})]})})]})}}]),n}(d.a.Component),ht=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this,t=this.props.closeModal;return Object($.jsxs)(P.a,{open:!0,onClose:t,children:[Object($.jsx)(P.a.Header,{children:"Share A File"}),Object($.jsx)(P.a.Content,{image:!0,children:Object($.jsxs)(P.a.Description,{children:[Object($.jsx)("div",{children:"You're about to share a file from your device."}),Object($.jsxs)("ul",{children:[Object($.jsx)("li",{children:"This feature is only supported on Chrome and Edge."}),Object($.jsx)("li",{children:"To test whether the file can be shared, you can try opening it locally with your browser to see if it will play properly."}),Object($.jsx)("li",{children:"Certain codecs, such as HEVC, AC3, and H265 will not play in Chrome (they may work in Edge)"}),Object($.jsxs)("li",{children:["There is a Chrome issue where the sharer needs to"," ",Object($.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://www.howtogeek.com/412738/how-to-turn-hardware-acceleration-on-and-off-in-chrome/",children:"disable hardware acceleration"})," ","in order for others to receive video."]})]}),Object($.jsx)(R.a,{onClick:function(){e.props.startFileShare(),e.props.closeModal()},children:"Start Fileshare"})]})})]})}}]),n}(d.a.Component),pt=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={loading:!1,searchResults:[]},e.uploadSubtitle=Object(r.a)(i.a.mark((function t(){var n,a,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(z.r)(".srt");case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return");case 5:a=n[0],(s=new FileReader).addEventListener("load",function(){var t=Object(r.a)(i.a.mark((function t(n){var a,r,s,o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=null===(a=n.target)||void 0===a?void 0:a.result,t.next=3,window.fetch(z.s+"/subtitle",{method:"POST",body:r,headers:{"Content-Type":"text/plain"}});case 3:return s=t.sent,t.next=6,s.json();case 6:o=t.sent,e.props.socket.emit("CMD:subtitle",z.s+"/subtitle/"+o.hash);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),s.readAsText(a);case 9:case"end":return t.stop()}}),t)}))),e}return Object(o.a)(n,[{key:"render",value:function(){var e=this,t=this.props.closeModal;return Object($.jsxs)(P.a,{open:!0,onClose:t,children:[Object($.jsxs)(P.a.Header,{children:["Subtitles are ",Boolean(this.props.currentSubtitle)?"on":"off",Object($.jsx)(R.a,{style:{float:"right"},color:"red",title:"Remove Subtitles",disabled:!Boolean(this.props.currentSubtitle)||!this.props.haveLock(),icon:!0,onClick:function(){e.props.socket.emit("CMD:subtitle",null)},children:Object($.jsx)(C.a,{name:"trash"})})]}),Object($.jsx)(P.a.Content,{image:!0,children:Object($.jsxs)(P.a.Description,{children:[!1,Object($.jsxs)(k.a,{columns:2,children:[Object($.jsx)(k.a.Column,{children:Object($.jsxs)(R.a,{loading:this.state.loading,color:"green",disabled:!this.props.haveLock(),icon:!0,labelPosition:"left",fluid:!0,onClick:Object(r.a)(i.a.mark((function t(){var n,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),t.next=3,window.fetch(z.s+"/searchSubtitles?url="+e.props.src);case 3:return n=t.sent,t.next=6,n.json();case 6:a=t.sent,e.setState({searchResults:a}),e.setState({loading:!1});case 9:case"end":return t.stop()}}),t)}))),children:[Object($.jsx)(C.a,{name:"search"}),"Search OpenSubtitles"]})}),Object($.jsx)(k.a.Column,{children:Object($.jsx)(B.a,{content:"Upload a .srt subtitle file for this video",trigger:Object($.jsxs)(R.a,{color:"violet",icon:!0,labelPosition:"left",fluid:!0,onClick:function(){return e.uploadSubtitle()},disabled:!this.props.haveLock(),children:[Object($.jsx)(C.a,{name:"closed captioning"}),"Upload Subtitle"]})})})]}),Object($.jsx)("div",{children:this.state.searchResults.map((function(t){var n;return Object($.jsx)("div",{children:Object($.jsx)(it.a,{label:t.SubFileName,name:"radioGroup",value:t.SubDownloadLink,checked:null===(n=e.props.currentSubtitle)||void 0===n?void 0:n.includes(t.SubDownloadLink),onChange:function(t,n){var a=n.value;e.props.socket.emit("CMD:subtitle",z.s+"/downloadSubtitles?url="+a)}})})}))})]})})]})}}]),n}(d.a.Component);window.watchparty={ourStream:void 0,videoRefs:{},videoPCs:{}};var mt=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={state:"starting",currentMedia:"",currentMediaPaused:!1,currentSubtitle:"",participants:[],rosterUpdateTS:Number(new Date),chat:[],playlist:[],tsMap:{},nameMap:{},pictureMap:{},myName:"",myPicture:"",loading:!0,scrollTimestamp:0,unreadCount:0,fullScreen:!1,controlsTimestamp:0,watchOptions:[],isScreenSharing:!1,isScreenSharingFile:!1,isVBrowser:!1,isYouTubeReady:!1,isAutoPlayable:!0,downloaded:0,total:0,speed:0,connections:0,multiStreamSelection:void 0,error:"",isErrorAuth:!1,settings:{},vBrowserResolution:"1280x720@30",isVBrowserLarge:!1,nonPlayableMedia:!1,currentTab:v.a.parse(window.location.search.substring(1)).tab||"chat",isSubscribeModalOpen:!1,isVBrowserModalOpen:!1,isScreenShareModalOpen:!1,isFileShareModalOpen:!1,isSubtitleModalOpen:!1,roomLock:"",controller:"",roomId:"",savedPasswords:{},errorMessage:"",successMessage:"",isChatDisabled:!1,showRightBar:!0,owner:void 0,vanity:void 0,password:void 0,roomLink:""},e.socket=null,e.watchPartyYTPlayer=null,e.ytDebounce=!0,e.screenShareStream=void 0,e.screenHostPC={},e.screenSharePC=void 0,e.progressUpdater=void 0,e.heartbeat=void 0,e.getRoomLink=function(t){return t?"".concat(window.location.origin,"/r/").concat(t):"".concat(window.location.origin).concat(e.state.roomId.replace("/","#"))},e.handleRoomState=function(t){e.setOwner(t.owner),e.setVanity(t.vanity),e.setPassword(t.password),e.setRoomLink(e.getRoomLink(t.vanity)),e.setIsChatDisabled(t.isChatDisabled),window.history.replaceState("","",e.getRoomLink(t.vanity))},e.loadSettings=Object(r.a)(i.a.mark((function t(){var n,a,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(z.s+"/settings");case 2:return n=t.sent,t.next=5,n.json();case 5:a=t.sent,r=Object(j.a)(Object(j.a)({},Ae()),a),e.setState({settings:r});case 8:case"end":return t.stop()}}),t)}))),e.loadSignInData=Object(r.a)(i.a.mark((function t(){var n,a,r,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.props.user)||!e.socket){t.next=9;break}return(r=null===(a=n.displayName)||void 0===a?void 0:a.split(" ")[0])&&e.updateName(null,{value:r}),t.next=6,Object(z.n)(n);case 6:(s=t.sent)&&e.updatePicture(s),e.updateUid(n);case 9:case"end":return t.stop()}}),t)}))),e.loadYouTube=function(){var t=document.createElement("script");t.src="https://www.youtube.com/iframe_api",document.body.append(t),window.onYouTubeIframeAPIReady=function(){var t=new window.YT.Player("leftYt",{events:{onReady:function(){e.watchPartyYTPlayer=t,e.setState({isYouTubeReady:!0,loading:!1}),e.isYouTube()&&e.socket.emit("CMD:askHost")},onStateChange:function(t){var n,a,i,r,s,o,c,l,u,d;("youtube"===Object(z.l)(e.state.currentMedia)&&t.data===(null===(n=window.YT)||void 0===n||null===(a=n.PlayerState)||void 0===a?void 0:a.CUED)&&e.setState({loading:!1}),"youtube"===Object(z.l)(e.state.currentMedia)&&t.data===(null===(i=window.YT)||void 0===i||null===(r=i.PlayerState)||void 0===r?void 0:r.ENDED)&&e.onVideoEnded(),e.ytDebounce&&(t.data===(null===(s=window.YT)||void 0===s||null===(o=s.PlayerState)||void 0===o?void 0:o.PLAYING)&&e.state.currentMediaPaused||t.data===(null===(c=window.YT)||void 0===c||null===(l=c.PlayerState)||void 0===l?void 0:l.PAUSED)&&!e.state.currentMediaPaused))&&(e.ytDebounce=!1,t.data===(null===(u=window.YT)||void 0===u||null===(d=u.PlayerState)||void 0===d?void 0:d.PLAYING)?(e.socket.emit("CMD:play"),e.doPlay()):(e.socket.emit("CMD:pause"),e.doPause()),window.setTimeout((function(){return e.ytDebounce=!0}),500))}}})}},e.setOwner=function(t){e.setState({owner:t})},e.setVanity=function(t){e.setState({vanity:t})},e.setPassword=function(t){e.setState({password:t})},e.setRoomLink=function(t){e.setState({roomLink:t})},e.init=Object(r.a)(i.a.mark((function t(){var n,a,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="/default",(a=window.location.hash.substring(1))&&(n="/"+a),!e.props.vanity){t.next=20;break}return t.prev=4,t.next=7,w.a.get(z.s+"/resolveRoom/"+e.props.vanity);case 7:if(!(r=t.sent).data.roomId){t.next=12;break}n=r.data.roomId,t.next=13;break;case 12:throw new Error("failed to resolve room name");case 13:t.next=20;break;case 15:return t.prev=15,t.t0=t.catch(4),console.error(t.t0),e.setState({error:"There's no room with this name."}),t.abrupt("return");case 20:e.setState({roomId:n},(function(){e.join(n)}));case 21:case"end":return t.stop()}}),t,null,[[4,15]])}))),e.join=function(){var t=Object(r.a)(i.a.mark((function t(n){var a,s,o,c,l,u,d;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a="";try{s=window.localStorage.getItem("watchparty-passwords"),o=JSON.parse(s||"{}"),e.setState({savedPasswords:o}),a=o[n]||""}catch(h){console.warn("[ALERT] Could not parse saved passwords")}c="",/^\d/.test(n.slice(1))&&(c=null!==(l=null===(u=/^\d+/.exec(n.slice(1)))||void 0===u?void 0:u[0])&&void 0!==l?l:""),d=Object(N.a)(z.s+n,{transports:["websocket"],query:{clientId:Object(z.g)(),password:a,shard:c}}),e.socket=d,d.on("connect",Object(r.a)(i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({state:"connected"}),n=window.localStorage.getItem("watchparty-username"),e.updateName(null,{value:n||Y()}),e.loadSignInData();case 4:case"end":return t.stop()}}),t)})))),d.on("error",(function(t){console.error(t),"Invalid namespace"===t?e.setState({error:"There's no room with this name."}):"not authorized"===t?e.setState({isErrorAuth:!0}):"room full"===t?e.setState({error:"This room is full."}):e.setState({error:"An error occurred."})})),d.on("errorMessage",(function(t){e.setState({errorMessage:t}),setTimeout((function(){e.setState({errorMessage:""})}),3e3)})),d.on("successMessage",(function(t){e.setState({successMessage:t}),setTimeout((function(){e.setState({successMessage:""})}),3e3)})),d.on("kicked",(function(){window.location.assign("/")})),d.on("REC:play",(function(){e.doPlay()})),d.on("REC:pause",(function(){e.doPause()})),d.on("REC:seek",(function(t){e.doSeek(t)})),d.on("REC:subtitle",(function(t){e.setState({currentSubtitle:t},(function(){e.loadSubtitles()}))})),d.on("REC:changeController",(function(t){e.setState({controller:t})})),d.on("REC:host",function(){var t=Object(r.a)(i.a.mark((function t(n){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.video||"",e.isScreenShare()&&!a.startsWith("screenshare://")&&e.stopScreenShare(),e.isFileShare()&&!a.startsWith("fileshare://")&&e.stopScreenShare(),!e.isScreenShare()||!a.startsWith("screenshare://")){t.next=5;break}return t.abrupt("return");case 5:if(!e.isFileShare()||!a.startsWith("fileshare://")){t.next=7;break}return t.abrupt("return");case 7:e.isVBrowser()&&!a.startsWith("vbrowser://")&&e.stopVBrowser(),e.setState({currentMedia:a,currentMediaPaused:n.paused,currentSubtitle:n.subtitle,loading:Boolean(n.video),nonPlayableMedia:!1,isVBrowserLarge:n.isVBrowserLarge,vBrowserResolution:n.isVBrowserLarge?"1920x1080@30":"1280x720@30",controller:n.controller},(function(){var t;if(e.state.isScreenSharingFile||e.isVBrowser()&&e.getVBrowserHost())return console.log("skipping REC:host video since fileshare is using leftVideo or this is a vbrowser"),void e.setLoadingFalse();var s=document.getElementById("leftVideo");null===s||void 0===s||s.pause(),null===(t=e.watchPartyYTPlayer)||void 0===t||t.stopVideo(),e.isYouTube()&&!e.watchPartyYTPlayer?console.log("YT player not ready, onReady callback will retry when it is"):e.isVBrowser()?console.log("not playing video as this is a vbrowser:// placeholder"):(e.doSrc(n.video,n.videoTS),n.paused||e.doPlay(),n.subtitle&&e.loadSubtitles(),null===s||void 0===s||s.addEventListener("canplay",(function(){e.setLoadingFalse(),e.jumpToLeader()}),{once:!0}),window.clearInterval(e.progressUpdater),e.setState({downloaded:0,total:0,speed:0}),a.includes("/stream?torrent=magnet")&&(e.progressUpdater=window.setInterval(Object(r.a)(i.a.mark((function t(){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.fetch(a.replace("/stream","/progress"));case 2:return n=t.sent,t.next=5,n.json();case 5:r=t.sent,e.setState({downloaded:r.downloaded,total:r.total,speed:r.speed,connections:r.connections});case 7:case"end":return t.stop()}}),t)}))),1e3)))}));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),d.on("REC:chat",(function(t){!Ae().disableChatSound&&document.visibilityState&&"visible"!==document.visibilityState&&new Audio("/clearly.mp3").play(),e.state.chat.push(t),e.setState({chat:e.state.chat,scrollTimestamp:Number(new Date),unreadCount:"chat"===e.state.currentTab?e.state.unreadCount:e.state.unreadCount+1})})),d.on("REC:tsMap",(function(t){e.setState({tsMap:t}),e.syncSubtitle()})),d.on("REC:nameMap",(function(t){e.setState({nameMap:t})})),d.on("REC:pictureMap",(function(t){e.setState({pictureMap:t})})),d.on("REC:lock",(function(t){e.setState({roomLock:t})})),d.on("roster",(function(t){e.setState({participants:t,rosterUpdateTS:Number(new Date)},(function(){e.updateScreenShare()}))})),d.on("chatinit",(function(t){e.setState({chat:t,scrollTimestamp:Number(new Date)})})),d.on("playlist",(function(t){e.setState({playlist:t})})),d.on("signalSS",function(){var t=Object(r.a)(i.a.mark((function t(n){var a,r,s,o,c,l;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.msg,r=n.from,s=n.sharer?e.screenSharePC:e.screenHostPC[r],void 0===a.ice){t.next=7;break}s.addIceCandidate(new RTCIceCandidate(a.ice)),t.next=22;break;case 7:if(!a.sdp||"offer"!==a.sdp.type){t.next=21;break}return c=a.sdp.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n"),a.sdp.sdp=c,t.next=12,s.setRemoteDescription(new RTCSessionDescription(a.sdp));case 12:return t.next=14,s.createAnswer();case 14:return(l=t.sent).sdp=null===(o=l.sdp)||void 0===o?void 0:o.replace("useinbandfec=1","useinbandfec=1; stereo=1; maxaveragebitrate=510000"),t.next=18,s.setLocalDescription(l);case 18:e.sendSignalSS(r,{sdp:s.localDescription},!n.sharer),t.next=22;break;case 21:a.sdp&&"answer"===a.sdp.type&&s.setRemoteDescription(new RTCSessionDescription(a.sdp));case 22:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),d.on("REC:getRoomState",e.handleRoomState),window.setInterval((function(){e.state.currentMedia&&e.socket.emit("CMD:ts",e.getCurrentTime())}),1e3);case 28:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.setupFileShare=Object(r.a)(i.a.mark((function t(){var n,a,r,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(z.r)();case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return");case 5:a=n[0],(r=document.getElementById("leftVideo")).srcObject=null,r.src=URL.createObjectURL(a),r.play(),(s=r.captureStream?r.captureStream():{}).onaddtrack=function(){console.log(s,s.getVideoTracks(),s.getAudioTracks()),!e.screenShareStream&&s.getVideoTracks().length&&s.getAudioTracks().length&&(s.getVideoTracks()[0].onended=e.stopScreenShare,e.screenShareStream=s,e.socket.emit("CMD:joinScreenShare",{file:!0}),e.setState({isScreenSharing:!0,isScreenSharingFile:!0}),s.onaddtrack=void 0)};case 12:case"end":return t.stop()}}),t)}))),e.setupScreenShare=Object(r.a)(i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!navigator.mediaDevices.getDisplayMedia){t.next=8;break}return t.next=3,navigator.mediaDevices.getDisplayMedia({video:{height:720,logicalSurface:!0},audio:{autoGainControl:!1,channelCount:2,echoCancellation:!1,latency:0,noiseSuppression:!1,sampleRate:48e3,sampleSize:16}});case 3:(n=t.sent).getVideoTracks()[0].onended=e.stopScreenShare,e.screenShareStream=n,e.socket.emit("CMD:joinScreenShare"),e.setState({isScreenSharing:!0});case 8:case"end":return t.stop()}}),t)}))),e.stopScreenShare=Object(r.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.screenShareStream&&e.screenShareStream.getTracks().forEach((function(e){e.stop()})),e.screenShareStream=void 0,e.screenSharePC&&(e.screenSharePC.close(),e.screenSharePC=void 0),Object.values(e.screenHostPC).forEach((function(e){e.close()})),e.screenHostPC={},e.state.isScreenSharing&&e.socket.emit("CMD:leaveScreenShare"),e.setState({isScreenSharing:!1,isScreenSharingFile:!1});case 7:case"end":return t.stop()}}),t)}))),e.updateScreenShare=Object(r.a)(i.a.mark((function t(){var n,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isScreenShare()||e.isFileShare()){t.next=2;break}return t.abrupt("return");case 2:(n=e.state.participants.find((function(e){return e.isScreenShare})))&&n.id===e.socket.id&&e.state.participants.forEach((function(t){var n=t.id;if((n!==e.socket.id||!e.state.isScreenSharingFile)&&!e.screenHostPC[n]){var a,s=new RTCPeerConnection({iceServers:Object(z.p)()});e.screenHostPC[n]=s,null===(a=e.screenShareStream)||void 0===a||a.getTracks().forEach((function(t){null!=e.screenShareStream&&s.addTrack(t,e.screenShareStream)})),s.onicecandidate=function(t){t.candidate&&e.sendSignalSS(n,{ice:t.candidate},!0)},s.onnegotiationneeded=Object(r.a)(i.a.mark((function t(){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.createOffer();case 2:return a=t.sent,t.next=5,s.setLocalDescription(a);case 5:e.sendSignalSS(n,{sdp:s.localDescription},!0);case 6:case"end":return t.stop()}}),t)})))}})),!n||e.screenSharePC||e.state.isScreenSharingFile||(a=new RTCPeerConnection({iceServers:Object(z.p)()}),e.screenSharePC=a,a.onicecandidate=function(t){t.candidate&&e.sendSignalSS(n.id,{ice:t.candidate})},a.ontrack=function(t){var n=document.getElementById("leftVideo");n&&(n.src="",n.srcObject=t.streams[0],e.doPlay())});case 5:case"end":return t.stop()}}),t)}))),e.startVBrowser=function(){var t=Object(r.a)(i.a.mark((function t(n,a){var r,s,o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.props.user,s=null===r||void 0===r?void 0:r.uid,t.next=4,null===r||void 0===r?void 0:r.getIdToken();case 4:o=t.sent,e.socket.emit("CMD:startVBrowser",{options:a,uid:s,token:o,rcToken:n});case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.stopVBrowser=Object(r.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.socket.emit("CMD:stopVBrowser");case 1:case"end":return t.stop()}}),t)}))),e.changeController=function(){var t=Object(r.a)(i.a.mark((function t(n,a){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.socket.emit("CMD:changeController",a.value);case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.sendSignalSS=function(){var t=Object(r.a)(i.a.mark((function t(n,a,r){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.socket.emit("signalSS",{to:n,msg:a,sharer:r});case 1:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}(),e.isYouTube=function(){return"youtube"===Object(z.l)(e.state.currentMedia)},e.isVideo=function(){return"video"===Object(z.l)(e.state.currentMedia)},e.isScreenShare=function(){return e.state.currentMedia.startsWith("screenshare://")},e.isFileShare=function(){return e.state.currentMedia.startsWith("fileshare://")},e.isVBrowser=function(){return e.state.currentMedia.startsWith("vbrowser://")},e.isHttp=function(){return e.state.currentMedia.startsWith("http")},e.getVBrowserPass=function(){return e.state.currentMedia.replace("vbrowser://","").split("@")[0]},e.getVBrowserHost=function(){return e.state.currentMedia.replace("vbrowser://","").split("@")[1]},e.getCurrentTime=function(){if(e.isVideo()){var t=document.getElementById("leftVideo");return null===t||void 0===t?void 0:t.currentTime}var n;if(e.isYouTube())return null===(n=e.watchPartyYTPlayer)||void 0===n?void 0:n.getCurrentTime()},e.getDuration=function(){var t;return e.isVideo()?document.getElementById("leftVideo").duration:e.isYouTube()?null===(t=e.watchPartyYTPlayer)||void 0===t?void 0:t.getDuration():0},e.isPauseDisabled=function(){return e.isScreenShare()||e.isVBrowser()},e.isPaused=function(){if(e.isVideo()){var t=document.getElementById("leftVideo");return t.paused||t.ended}var n,a,i,r,s,o;return!!e.isYouTube()&&((null===(n=e.watchPartyYTPlayer)||void 0===n?void 0:n.getPlayerState())===(null===(a=window.YT)||void 0===a||null===(i=a.PlayerState)||void 0===i?void 0:i.PAUSED)||(null===(r=e.watchPartyYTPlayer)||void 0===r?void 0:r.getPlayerState())===(null===(s=window.YT)||void 0===s||null===(o=s.PlayerState)||void 0===o?void 0:o.ENDED))},e.isMuted=function(){if(e.isVideo()){var t=document.getElementById("leftVideo");return null===t||void 0===t?void 0:t.muted}var n;return!!e.isYouTube()&&(null===(n=e.watchPartyYTPlayer)||void 0===n?void 0:n.isMuted())},e.isSubtitled=function(){if(e.isVideo())return Boolean(e.state.currentSubtitle);if(e.isYouTube())try{var t,n=null===(t=e.watchPartyYTPlayer)||void 0===t?void 0:t.getOption("captions","track");return Boolean(n&&n.languageCode)}catch(a){return console.warn(a),!1}return!1},e.jumpToLeader=function(){var t=e.getLeaderTime();t>0&&(console.log("jump to leader at ",t),e.doSeek(t))},e.doSrc=function(){var t=Object(r.a)(i.a.mark((function t(n,a){var r,s,o,c,l;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("doSrc",n,a),!(e.isScreenShare()||e.isFileShare()||e.isVBrowser())){t.next=3;break}return t.abrupt("return");case 3:e.isVideo()&&(r=document.getElementById("leftVideo"))&&(r.srcObject=null,r.src=n,r.currentTime=a,r.innerHTML=""),e.isYouTube()&&(o=new window.URL(n),c=v.a.parse(o.search.substring(1)).v,l=n.split("/").slice(-1)[0],null===(s=e.watchPartyYTPlayer)||void 0===s||s.cueVideoById(c||l,a));case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.doPlay=Object(r.a)(i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.state.isAutoPlayable,t.t0){t.next=5;break}return t.next=4,Object(z.t)();case 4:t.t0=t.sent;case 5:n=t.t0,e.setState({currentMediaPaused:!1,isAutoPlayable:n},Object(r.a)(i.a.mark((function t(){var n,a,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isVideo()){t.next=14;break}return n=document.getElementById("leftVideo"),"m3u8"!==(a=null===n||void 0===n?void 0:n.src.split("."))[a.length-1]||(null===n||void 0===n?void 0:n.canPlayType("application/vnd.apple.mpegurl"))||((r=new window.Hls).loadSource(n.src),r.attachMedia(n)),t.prev=4,e.state.isAutoPlayable?e.setMute(!1):e.setMute(!0),t.next=8,null===n||void 0===n?void 0:n.play();case 8:t.next=14;break;case 10:t.prev=10,t.t0=t.catch(4),console.warn(t.t0),"NotSupportedError"===t.t0.name&&e.setState({loading:!1,nonPlayableMedia:!0});case 14:e.isYouTube()&&setTimeout((function(){var t;console.log("play yt"),null===(t=e.watchPartyYTPlayer)||void 0===t||t.playVideo()}),200);case 15:case"end":return t.stop()}}),t,null,[[4,10]])}))));case 7:case"end":return t.stop()}}),t)}))),e.doPause=function(){e.setState({currentMediaPaused:!0},Object(r.a)(i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.isVideo()&&document.getElementById("leftVideo").pause(),e.isYouTube()&&(console.log("pause"),null===(n=e.watchPartyYTPlayer)||void 0===n||n.pauseVideo());case 2:case"end":return t.stop()}}),t)}))))},e.doSeek=function(t){var n;e.isVideo()&&(document.getElementById("leftVideo").currentTime=t);e.isYouTube()&&(null===(n=e.watchPartyYTPlayer)||void 0===n||n.seekTo(t,!0))},e.togglePlay=function(){if(!e.isPauseDisabled()){var t=!0;if(e.isVideo()){var n=document.getElementById("leftVideo");t=n.paused||n.ended}else if(e.isYouTube()){var a,i;t=(null===(a=e.watchPartyYTPlayer)||void 0===a?void 0:a.getPlayerState())===(null===(i=window.YT)||void 0===i?void 0:i.PlayerState.PAUSED)||e.getCurrentTime()===e.getDuration()}t?(e.socket.emit("CMD:play"),e.doPlay()):(e.socket.emit("CMD:pause"),e.doPause())}},e.onSeek=function(t,n){var a=n;if(t){var i=t.target.getBoundingClientRect();a=(t.clientX-i.left)/i.width*e.getDuration()}a=Math.max(a,0),e.doSeek(a),e.socket.emit("CMD:seek",a)},e.onFullScreenChange=function(){e.setState({fullScreen:Boolean(document.fullscreenElement)})},e.onKeydown=function(t){document.activeElement&&"BODY"!==document.activeElement.tagName||(" "===t.key?(t.preventDefault(),e.togglePlay()):"ArrowRight"===t.key?e.onSeek(null,e.getCurrentTime()+10):"ArrowLeft"===t.key?e.onSeek(null,e.getCurrentTime()-10):"c"===t.key?e.toggleSubtitle():"t"===t.key?e.fullScreen(!1):"f"===t.key?e.fullScreen(!0):"m"===t.key&&e.toggleMute())},e.fullScreen=function(){var t=Object(r.a)(i.a.mark((function t(n){var a,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=document.getElementById("theaterContainer"),(n||Object(z.q)())&&(a=e.isVBrowser()&&!Object(z.q)()?document.getElementById("leftVideoParent"):document.getElementById(e.isYouTube()?"leftYt":"leftVideo")),a.requestFullscreen||!a.webkitEnterFullScreen){t.next=5;break}return a.webkitEnterFullscreen(),t.abrupt("return");case 5:if(document.fullscreenElement){t.next=9;break}return t.next=8,a.requestFullscreen();case 8:return t.abrupt("return");case 9:return r=document.fullscreenElement!==a,t.next=12,document.exitFullscreen();case 12:if(!r){t.next=15;break}return t.next=15,a.requestFullscreen();case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.toggleMute=function(){e.setMute(!e.isMuted())},e.setMute=function(t){if(e.isVideo()){var n=document.getElementById("leftVideo");n&&(n.muted=t);var a=document.getElementById("iPhoneAudio");a&&(a.muted=t)}var i,r;e.isYouTube()&&(t?null===(i=e.watchPartyYTPlayer)||void 0===i||i.mute():null===(r=e.watchPartyYTPlayer)||void 0===r||r.unMute())},e.setVolume=function(t){var n;e.isVideo()&&(document.getElementById("leftVideo").volume=t);e.isYouTube()&&(null===(n=e.watchPartyYTPlayer)||void 0===n||n.setVolume(100*t))},e.getVolume=function(){var t;return e.isVideo()?document.getElementById("leftVideo").volume:e.isYouTube()?(null===(t=e.watchPartyYTPlayer)||void 0===t?void 0:t.getVolume())/100:void 0},e.loadSubtitles=Object(r.a)(i.a.mark((function t(){var n,a,r,s,o,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=document.getElementById("leftVideo"),e.isSubtitled()){t.next=5;break}n.innerHTML="",t.next=24;break;case 5:if(n.innerHTML="",!(a=e.state.currentSubtitle)){t.next=24;break}return t.next=10,window.fetch(a);case 10:return r=t.sent,t.next=13,r.arrayBuffer();case 13:return s=t.sent,t.next=16,L()(new Blob([s]));case 16:o=t.sent,(c=document.createElement("track")).kind="captions",c.label="English",c.srclang="en",c.src=o,n.appendChild(c),n.textTracks[0].mode="showing";case 24:case"end":return t.stop()}}),t)}))),e.syncSubtitle=function(){var t=e.state.participants.find((function(e){return e.isScreenShare}));if(t&&t.id!==e.socket.id){var n=document.getElementById("leftVideo"),a=null===n||void 0===n?void 0:n.textTracks[0],i=n.currentTime-e.state.tsMap[t.id];if(a&&a.cues&&i)for(var r=0;r<a.cues.length;r++){var s,o=null===a||void 0===a||null===(s=a.cues)||void 0===s?void 0:s[r];o&&(o.origStart||(o.origStart=o.startTime,o.origEnd=o.endTime),o.startTime=o.origStart+i,o.endTime=o.origEnd+i)}}},e.toggleSubtitle=function(){if(e.isVideo()&&e.setState({isSubtitleModalOpen:!0}),e.isYouTube())if(e.isSubtitled()){var t;null===(t=e.watchPartyYTPlayer)||void 0===t||t.setOption("captions","track",{})}else{var n,a,i;null===(n=e.watchPartyYTPlayer)||void 0===n||n.setOption("captions","reload",!0);var r=null===(a=e.watchPartyYTPlayer)||void 0===a?void 0:a.getOption("captions","tracklist");null===(i=e.watchPartyYTPlayer)||void 0===i||i.setOption("captions","track",null===r||void 0===r?void 0:r[0])}},e.setMedia=function(t,n){e.socket.emit("CMD:host",n.value)},e.playlistAdd=function(t,n){e.socket.emit("CMD:playlistAdd",n.value)},e.playlistMove=function(t,n){e.socket.emit("CMD:playlistMove",{index:t,toIndex:n})},e.playlistDelete=function(t){e.socket.emit("CMD:playlistDelete",t)},e.launchMultiSelect=function(t){e.setState({multiStreamSelection:t})},e.resetMultiSelect=function(){e.setState({multiStreamSelection:void 0})},e.updateName=function(t,n){e.setState({myName:n.value}),e.socket.emit("CMD:name",n.value),window.localStorage.setItem("watchparty-username",n.value)},e.updatePicture=function(t){e.setState({myPicture:t}),e.socket.emit("CMD:picture",t)},e.updateUid=function(){var t=Object(r.a)(i.a.mark((function t(n){var a,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.uid,t.next=3,n.getIdToken();case 3:r=t.sent,e.socket.emit("CMD:uid",{uid:a,token:r});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getMediaDisplayName=function(t){if(!t)return"";if("youtube"===Object(z.l)(t))return t;if(t.startsWith("screenshare://")){var n=t.slice("screenshare://".length);return e.state.nameMap[n]+"'s screen"}if(t.startsWith("fileshare://")){var a=t.slice("fileshare://".length);return e.state.nameMap[a]+"'s file"}if(t.startsWith("vbrowser://"))return"Virtual Browser"+(e.state.isVBrowserLarge?"+":"");if(t.includes("/stream?torrent=magnet")){var i=new URL(t).search,r=v.a.parse(i.substring(1)).torrent;return O.a.decode(r).name}return t},e.getFileName=function(e){return e.split("/").slice(-1)[0]},e.setLoadingFalse=function(){e.setState({loading:!1})},e.setRoomLock=function(){var t=Object(r.a)(i.a.mark((function t(n){var a,r,s,o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=null===(a=e.props.user)||void 0===a?void 0:a.uid,t.next=3,null===(r=e.props.user)||void 0===r?void 0:r.getIdToken();case 3:o=t.sent,e.socket.emit("CMD:lock",{uid:s,token:o,locked:n});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.haveLock=function(){var t;return!e.state.roomLock||(null===(t=e.props.user)||void 0===t?void 0:t.uid)===e.state.roomLock},e.setIsChatDisabled=function(t){return e.setState({isChatDisabled:t})},e.clearChat=Object(r.a)(i.a.mark((function t(){var n,a,r,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=null===(n=e.props.user)||void 0===n?void 0:n.uid,t.next=3,null===(a=e.props.user)||void 0===a?void 0:a.getIdToken();case 3:s=t.sent,e.socket.emit("CMD:clearchat",{uid:r,token:s});case 5:case"end":return t.stop()}}),t)}))),e.getLeaderTime=function(){return e.state.participants.length>2?Object(z.a)(Object.values(e.state.tsMap)):Math.max.apply(Math,Object(f.a)(Object.values(e.state.tsMap)))},e.onVideoEnded=function(){var t;if(e.socket.emit("CMD:playlistNext",e.state.currentMedia),null===(t=e.state.currentMedia)||void 0===t?void 0:t.includes("/stream?torrent=magnet")){var n=new URL(e.state.currentMedia),a=n.searchParams.get("fileIndex");null!=a&&(n.searchParams.set("fileIndex",(Number(a)+1).toString()),e.setMedia(null,{value:n.toString()}))}},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=Object(r.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.onfullscreenchange=this.onFullScreenChange,document.onkeydown=this.onKeydown,this.heartbeat=window.setInterval((function(){window.fetch(z.s+"/ping")}),6e5),e.next=5,Object(z.t)();case 5:t=e.sent,this.setState({isAutoPlayable:t}),this.loadSettings(),this.loadYouTube(),this.init();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){document.removeEventListener("fullscreenchange",this.onFullScreenChange),document.removeEventListener("keydown",this.onKeydown),window.clearInterval(this.heartbeat)}},{key:"componentDidUpdate",value:function(e){this.props.user&&!e.user&&this.loadSignInData()}},{key:"render",value:function(){var e,t=this,n=this.state.participants.find((function(e){return e.isScreenShare})),a=Object($.jsx)(et,{togglePlay:this.togglePlay,onSeek:this.onSeek,fullScreen:this.fullScreen,toggleMute:this.toggleMute,toggleSubtitle:this.toggleSubtitle,setVolume:this.setVolume,jumpToLeader:this.jumpToLeader,paused:this.state.currentMediaPaused,muted:this.isMuted(),subtitled:this.isSubtitled(),currentTime:this.getCurrentTime(),duration:this.getDuration(),disabled:!this.haveLock(),leaderTime:this.isHttp()?this.getLeaderTime():void 0,isPauseDisabled:this.isPauseDisabled()},this.state.controlsTimestamp),i=Object($.jsx)(ue,{user:this.props.user,isSubscriber:this.props.isSubscriber,isCustomer:this.props.isCustomer}),r=this.state.showRightBar||this.state.fullScreen,s=Object($.jsxs)(k.a.Column,{width:r?4:1,style:{display:"flex",flexDirection:"column"},className:"".concat(this.state.fullScreen?"fullHeightColumnFullscreen":"fullHeightColumn"),children:[Object($.jsx)(S.a,{inverted:!0,fluid:!0,label:"My name is:",value:this.state.myName,onChange:this.updateName,style:{visibility:r?"":"hidden"},icon:Object($.jsx)(C.a,{onClick:function(){return t.updateName(null,{value:Y()})},name:"refresh",inverted:!0,circular:!0,link:!0})}),Object($.jsxs)(T.a,{inverted:!0,widths:3,style:{marginTop:"4px",marginBottom:"4px",visibility:r?"":"hidden"},children:[Object($.jsxs)(T.a.Item,{name:"chat",active:"chat"===this.state.currentTab,onClick:function(){t.setState({currentTab:"chat",unreadCount:0})},as:"a",children:["Chat",this.state.unreadCount>0&&Object($.jsx)(M.a,{circular:!0,color:"red",children:this.state.unreadCount})]}),Object($.jsxs)(T.a.Item,{name:"people",active:"people"===this.state.currentTab,onClick:function(){return t.setState({currentTab:"people"})},as:"a",children:["People",Object($.jsx)(M.a,{circular:!0,color:Object(z.h)(this.state.participants.length.toString()),children:this.state.participants.length})]}),Object($.jsx)(T.a.Item,{name:"settings",active:"settings"===this.state.currentTab,onClick:function(){return t.setState({currentTab:"settings"})},as:"a",children:"Settings"})]}),Object($.jsx)(X,{chat:this.state.chat,nameMap:this.state.nameMap,pictureMap:this.state.pictureMap,socket:this.socket,scrollTimestamp:this.state.scrollTimestamp,getMediaDisplayName:this.getMediaDisplayName,hide:"chat"!==this.state.currentTab||!r,isChatDisabled:this.state.isChatDisabled,owner:this.state.owner,user:this.props.user}),"connected"===this.state.state&&Object($.jsx)(Ne,{socket:this.socket,participants:this.state.participants,nameMap:this.state.nameMap,pictureMap:this.state.pictureMap,tsMap:this.state.tsMap,rosterUpdateTS:this.state.rosterUpdateTS,hide:"people"!==this.state.currentTab||!r,owner:this.state.owner,user:this.props.user}),Object($.jsx)(st,{hide:"settings"!==this.state.currentTab||!r,user:this.props.user,roomLock:this.state.roomLock,setRoomLock:this.setRoomLock,socket:this.socket,isSubscriber:this.props.isSubscriber,roomId:this.state.roomId,isChatDisabled:this.state.isChatDisabled,setIsChatDisabled:this.setIsChatDisabled,owner:this.state.owner,setOwner:this.setOwner,vanity:this.state.vanity,setVanity:this.setVanity,roomLink:this.state.roomLink,password:this.state.password,setPassword:this.setPassword,clearChat:this.clearChat})]});return Object($.jsxs)(d.a.Fragment,{children:[!this.state.isAutoPlayable&&Object($.jsx)(P.a,{inverted:!0,basic:!0,open:!0,children:Object($.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object($.jsxs)(R.a,{primary:!0,size:"large",onClick:function(){t.setState({isAutoPlayable:!0}),t.setMute(!1),t.setVolume(1)},icon:!0,labelPosition:"left",children:[Object($.jsx)(C.a,{name:"volume up"}),"Click to unmute"]})})}),this.state.multiStreamSelection&&Object($.jsx)(Ue,{streams:this.state.multiStreamSelection,setMedia:this.setMedia,resetMultiSelect:this.resetMultiSelect}),this.state.isVBrowserModalOpen&&Object($.jsx)(nt,{isSubscriber:this.props.isSubscriber,subscribeButton:i,closeModal:function(){return t.setState({isVBrowserModalOpen:!1})},startVBrowser:this.startVBrowser,user:this.props.user}),this.state.isScreenShareModalOpen&&Object($.jsx)(dt,{closeModal:function(){return t.setState({isScreenShareModalOpen:!1})},startScreenShare:this.setupScreenShare}),this.state.isFileShareModalOpen&&Object($.jsx)(ht,{closeModal:function(){return t.setState({isFileShareModalOpen:!1})},startFileShare:this.setupFileShare}),this.state.isSubtitleModalOpen&&Object($.jsx)(pt,{closeModal:function(){return t.setState({isSubtitleModalOpen:!1})},socket:this.socket,currentSubtitle:this.state.currentSubtitle,src:this.state.currentMedia,haveLock:this.haveLock}),this.state.error&&Object($.jsx)(ct,{error:this.state.error}),this.state.isErrorAuth&&Object($.jsx)(ut,{savedPasswords:this.state.savedPasswords,roomId:this.state.roomId}),this.state.errorMessage&&Object($.jsx)(D.a,{negative:!0,header:"Error",content:this.state.errorMessage,style:{position:"fixed",bottom:"10px",right:"10px",zIndex:1e3}}),this.state.successMessage&&Object($.jsx)(D.a,{positive:!0,header:"Success",content:this.state.successMessage,style:{position:"fixed",bottom:"10px",right:"10px",zIndex:1e3}}),Object($.jsx)(be,{user:this.props.user,isCustomer:this.props.isCustomer,isSubscriber:this.props.isSubscriber}),Object($.jsx)(k.a,{stackable:!0,celled:"internally",children:Object($.jsxs)(k.a.Row,{id:"theaterContainer",children:[Object($.jsxs)(k.a.Column,{width:this.state.showRightBar?12:15,className:this.state.fullScreen?"fullHeightColumnFullscreen":"fullHeightColumn",children:[Object($.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[!this.state.fullScreen&&Object($.jsxs)(d.a.Fragment,{children:[Object($.jsx)(Ge,{setMedia:this.setMedia,playlistAdd:this.playlistAdd,playlistDelete:this.playlistDelete,playlistMove:this.playlistMove,currentMedia:this.state.currentMedia,getMediaDisplayName:this.getMediaDisplayName,launchMultiSelect:this.launchMultiSelect,streamPath:this.state.settings.streamPath,mediaPath:this.state.settings.mediaPath,disabled:!this.haveLock(),playlist:this.state.playlist}),Object($.jsx)(bt,{}),Object($.jsxs)("div",{className:"mobileStack",style:{display:"flex",gap:"4px"},children:[this.screenShareStream&&Object($.jsxs)(R.a,{fluid:!0,className:"toolButton",icon:!0,labelPosition:"left",color:"red",onClick:this.stopScreenShare,disabled:(null===n||void 0===n?void 0:n.id)!==(null===(e=this.socket)||void 0===e?void 0:e.id),children:[Object($.jsx)(C.a,{name:"cancel"}),"Stop Share"]}),!this.screenShareStream&&!n&&!this.isVBrowser()&&Object($.jsx)(B.a,{content:'Share a tab or an application. Make sure to check "Share audio" for best results.',trigger:Object($.jsxs)(R.a,{fluid:!0,className:"toolButton",disabled:!this.haveLock(),icon:!0,labelPosition:"left",color:"instagram",onClick:function(){t.setState({isScreenShareModalOpen:!0})},children:[Object($.jsx)(C.a,{name:"slideshare"}),"Screenshare"]})}),!this.screenShareStream&&!n&&!this.isVBrowser()&&Object($.jsx)(B.a,{content:"Launch a shared virtual browser",trigger:Object($.jsxs)(R.a,{fluid:!0,className:"toolButton",disabled:!this.haveLock(),icon:!0,labelPosition:"left",color:"green",onClick:function(){t.setState({isVBrowserModalOpen:!0})},children:[Object($.jsx)(C.a,{name:"desktop"}),"VBrowser"]})}),this.isVBrowser()&&Object($.jsx)(B.a,{content:"Choose the person controlling the VBrowser",trigger:Object($.jsx)(E.a,{icon:"keyboard",labeled:!0,className:"icon",style:{height:"36px"},button:!0,value:this.state.controller,placeholder:"No controller",clearable:!0,onChange:this.changeController,selection:!0,disabled:!this.haveLock(),options:this.state.participants.map((function(e){return{text:t.state.nameMap[e.id]||e.id,value:e.id}}))})}),this.isVBrowser()&&Object($.jsx)(E.a,{icon:"desktop",labeled:!0,className:"icon",style:{height:"36px"},button:!0,disabled:!this.haveLock(),value:this.state.vBrowserResolution,onChange:function(e,n){return t.setState({vBrowserResolution:n.value})},selection:!0,options:[{text:"1080p (WatchParty Plus)",value:"1920x1080@30",disabled:!this.state.isVBrowserLarge},{text:"720p",value:"1280x720@30"},{text:"576p",value:"1024x576@60"},{text:"486p",value:"864x486@60"},{text:"360p",value:"640x360@60"}]}),this.isVBrowser()&&Object($.jsxs)(R.a,{fluid:!0,className:"toolButton",icon:!0,labelPosition:"left",color:"red",disabled:!this.haveLock(),onClick:this.stopVBrowser,children:[Object($.jsx)(C.a,{name:"cancel"}),"Stop VBrowser"]}),!this.screenShareStream&&!n&&!this.isVBrowser()&&Object($.jsx)(B.a,{content:"Stream your own video file",trigger:Object($.jsxs)(R.a,{fluid:!0,className:"toolButton",disabled:!this.haveLock(),icon:!0,labelPosition:"left",onClick:function(){t.setState({isFileShareModalOpen:!0})},children:[Object($.jsx)(C.a,{name:"file"}),"File"]})}),!1,Boolean(this.state.settings.mediaPath)&&Object($.jsx)(Qe,{setMedia:this.setMedia,playlistAdd:this.playlistAdd,type:"media",streamPath:this.state.settings.streamPath,mediaPath:this.state.settings.mediaPath,disabled:!this.haveLock()}),Boolean(this.state.settings.streamPath)&&Object($.jsx)(Qe,{setMedia:this.setMedia,playlistAdd:this.playlistAdd,type:"stream",streamPath:this.state.settings.streamPath,mediaPath:this.state.settings.mediaPath,launchMultiSelect:this.launchMultiSelect,disabled:!this.haveLock()})]}),Object($.jsx)(bt,{})]}),Object($.jsx)("div",{style:{flexGrow:1},children:Object($.jsxs)("div",{id:"playerContainer",children:[(this.state.loading||!this.state.currentMedia||this.state.nonPlayableMedia)&&Object($.jsxs)("div",{id:"loader",className:"videoContent",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[this.state.loading&&Object($.jsx)(I.a,{active:!0,children:Object($.jsx)(_.a,{children:this.isVBrowser()?"Launching virtual browser. This can take up to a minute.":""})}),!this.state.loading&&!this.state.currentMedia&&Object($.jsx)(D.a,{color:"yellow",icon:"hand point up",header:"You're not watching anything!",content:"Pick something to watch above."}),!this.state.loading&&this.state.nonPlayableMedia&&Object($.jsx)(D.a,{color:"red",icon:"frown",header:"It doesn't look like this is a media file!",content:"Maybe you meant to launch a VBrowser if you're trying to visit a web page?"})]}),Object($.jsx)("iframe",{style:{display:this.isYouTube()&&!this.state.loading?"block":"none"},title:"YouTube",id:"leftYt",className:"videoContent",allowFullScreen:!0,frameBorder:"0",allow:"autoplay",src:"https://www.youtube.com/embed/?enablejsapi=1&controls=0&rel=0"}),this.isVBrowser()&&this.getVBrowserPass()&&this.getVBrowserHost()?Object($.jsx)(_e,{username:this.socket.id,password:this.getVBrowserPass(),hostname:this.getVBrowserHost(),controlling:this.state.controller===this.socket.id,setLoadingFalse:this.setLoadingFalse,resolution:this.state.vBrowserResolution,doPlay:this.doPlay,setResolution:function(e){return t.setState({vBrowserResolution:e})}}):Object($.jsx)("video",{style:{display:this.isVideo()&&!this.state.loading||this.state.fullScreen?"block":"none",width:"100%",maxHeight:"calc(100vh - 62px - 36px - 36px - 8px - 41px - 16px)"},id:"leftVideo",onEnded:this.onVideoEnded,playsInline:!0})]})}),this.state.currentMedia&&a,Boolean(this.state.total)&&Object($.jsx)("div",{children:Object($.jsx)(V.a,{size:"tiny",color:"green",inverted:!0,value:this.state.downloaded,total:this.state.total,label:Math.min(this.state.downloaded/this.state.total*100,100).toFixed(2)+"% - "+Object(z.e)(this.state.speed)+" - "+this.state.connections+" connections"})})]}),Object($.jsx)(R.a,{style:{position:"absolute",top:"50%",right:"calc(0% - 18px)",zIndex:900},circular:!0,size:"mini",icon:this.state.showRightBar?"angle right":"angle left",onClick:function(){return t.setState({showRightBar:!t.state.showRightBar})}})]}),s]})})]})}}]),n}(d.a.Component),bt=function(){return Object($.jsx)("div",{style:{height:"4px",flexShrink:0}})},ft=n(411),jt=n(62),gt=n.n(jt),vt=function(e){var t=e.user;return Object($.jsx)("div",{children:Object($.jsxs)("div",{className:gt.a.container,children:[Object($.jsx)(wt,{heroText:"Watch videos in-sync with friends far away.",subText:"No registration or download required.",action:Object($.jsx)("div",{style:{marginTop:"8px",width:"160px"},children:Object($.jsx)(he,{user:t})}),image:"/screenshot4.png"}),Object($.jsx)(at.a,{horizontal:!0,children:Object($.jsxs)(re.a,{inverted:!0,as:"h4",children:[Object($.jsx)(C.a,{name:"film"}),"Multiple ways to watch"]})}),Object($.jsxs)("div",{className:gt.a.featureSection,children:[Object($.jsx)(yt,{icon:"slideshare",title:"Screensharing",text:"Share a browser tab or an application."}),Object($.jsx)(yt,{icon:"desktop",title:"VBrowser",text:"Launch a virtual browser in the cloud that all room members can view and control. No need to worry about slow upload speeds!"}),Object($.jsx)(yt,{icon:"file",title:"File",text:"Upload and stream your own file."}),Object($.jsx)(yt,{icon:"linkify",title:"URL",text:"Paste in a URL for everyone to watch from."}),Object($.jsx)(yt,{icon:"youtube",title:"YouTube",text:"Watch videos in-sync from YouTube."})]}),Object($.jsx)(wt,{heroText:"React to moments together.",subText:"Find moments of shared joy even when you're apart.",image:"/screenshot18.png",color:"green"}),Object($.jsx)(at.a,{horizontal:!0,children:Object($.jsxs)(re.a,{inverted:!0,as:"h4",children:[Object($.jsx)(C.a,{name:"cogs"}),"Features"]})}),Object($.jsxs)("div",{className:gt.a.featureSection,children:[Object($.jsx)(yt,{icon:"sync",title:"Synchronized",text:"Starts, stops, and seeks are synchronized to everyone, so take those restroom and snack breaks without worrying about falling behind."}),Object($.jsx)(yt,{icon:"conversation",title:"Chat",text:"Chat with others in your room. Memes and inside jokes encouraged."}),Object($.jsx)(yt,{icon:"video",title:"Video chat",text:"Jump into video chat if there's something that you just can't express with text."})]}),Object($.jsx)(wt,{heroText:"Theater mode.",subText:"Bring video and chat front-and-center for minimal distractions.",image:"/screenshot14.png"}),Object($.jsx)(at.a,{horizontal:!0}),Object($.jsxs)("div",{style:{padding:"30px",display:"flex",flexDirection:"column",alignItems:"center"},children:[Object($.jsx)("div",{className:gt.a.heroText,children:"Get started!"}),Object($.jsx)("div",{className:gt.a.featureSection,children:Object($.jsxs)(ft.a.Group,{style:{margin:"8px"},children:[Object($.jsxs)(ft.a,{children:[Object($.jsx)(C.a,{name:"certificate"}),Object($.jsxs)(ft.a.Content,{children:[Object($.jsx)(ft.a.Title,{children:"1."}),Object($.jsx)(ft.a.Description,{children:"Make a room"})]})]}),Object($.jsxs)(ft.a,{children:[Object($.jsx)(C.a,{name:"group"}),Object($.jsxs)(ft.a.Content,{children:[Object($.jsx)(ft.a.Title,{children:"2."}),Object($.jsx)(ft.a.Description,{children:"Share link with friends"})]})]}),Object($.jsxs)(ft.a,{children:[Object($.jsx)(C.a,{name:"film"}),Object($.jsxs)(ft.a.Content,{children:[Object($.jsx)(ft.a.Title,{children:"3."}),Object($.jsx)(ft.a.Description,{children:"Pick something to watch"})]})]}),Object($.jsxs)(ft.a,{children:[Object($.jsx)(C.a,{name:"thumbs up outline"}),Object($.jsxs)(ft.a.Content,{children:[Object($.jsx)(ft.a.Title,{children:"4."}),Object($.jsx)(ft.a.Description,{children:"Success!"})]})]})]})}),Object($.jsx)("div",{style:{width:"160px"},children:Object($.jsx)(he,{user:t})})]})]})})},yt=function(e){var t=e.icon,n=e.text,a=e.title;return Object($.jsxs)("div",{style:{display:"flex",flex:"1 1 0px",flexDirection:"column",alignItems:"center",padding:"10px",minWidth:"180px"},children:[Object($.jsx)(C.a,{fitted:!0,size:"huge",name:t}),Object($.jsx)("h4",{className:gt.a.featureTitle,children:a}),Object($.jsx)("div",{className:gt.a.featureText,children:n})]})},wt=function(e){var t=e.heroText,n=e.subText,a=e.action,i=e.image,r=e.color;return Object($.jsx)("div",{className:"".concat(gt.a.hero," ").concat("green"===r?gt.a.green:""),children:Object($.jsxs)("div",{className:gt.a.heroInner,children:[Object($.jsxs)("div",{style:{padding:"30px",flex:"1 1 0"},children:[Object($.jsx)("div",{className:gt.a.heroText,children:t}),Object($.jsx)("div",{className:gt.a.subText,children:n}),a]}),Object($.jsx)("div",{style:{flex:"1 1 0"},children:Object($.jsx)("img",{alt:"hero",style:{width:"100%",borderRadius:"10px"},src:i})})]})})},xt=n(400),Ot={color:"white",margin:"50px",maxWidth:"800px"},kt=function(){return Object($.jsx)("div",{style:Ot,children:Object($.jsx)(xt.a,{children:"\nPrivacy Policy\n====\n\nRooms\n----\n- By default, rooms are temporary and expire after one day of inactivity.\n- Users have the option of making a room permanent, which can be undone at any time.\n- We do not keep logs of the content that users watch.\n\nPersonal Information\n----\n- You are not required to register to use the service, but you have the option to sign in with an email or authentication provider, which will be used to display your name and picture in the rooms you join.\n- If you provide this information, we may use it to contact you regarding your use of the service, or to link your account to a subscription.\n- We do not sell personal information to third parties.\n- You have the right to request deletion of your user data, in accordance with various laws governing data protection. Please contact support@watchparty.me to request user data deletion.\n- Payment information is handled by providers such as Stripe. We do not collect or access financial information directly.\n\nCookies\n----\n- We use services such as Google Analytics to measure usage. These services may set cookies or other information locally on your device.\n\nVirtual Browsers\n----\n- Virtual machines are recycled after each session ends and any data on them is destroyed.\n- Your commands are encrypted while in-transit to the virtual machine.\n\nYouTube\n----\n- The service provides the ability to search and play YouTube videos. Google/YouTube may use data provided to the search service in accordance with the [Google Privacy Policy](https://policies.google.com/privacy).\n"})})},St=function(){return Object($.jsx)("div",{style:Ot,children:Object($.jsx)(xt.a,{children:"\nTerms of Service\n====\nBy using this service you agree to the following terms:\n- You are over 13 years of age\n- Your use of the service may be terminated if you are found to be sharing illegal or infringing content\n- The service provides no guarantee of uptime or availability\n- You use the service at your own risk of encountering objectionable content, as we do not actively moderate rooms unless content is found to be illegal or infringing\n\nSubscriptions\n----\n- If you are dissatisfied with the service for any reason or believe you have been charged in error, please contact support@watchparty.me.\n- We will provide a full refund of the most recent payment, no questions asked.\n\nYouTube\n----\nThe service provides the ability to search and play YouTube videos. By using the YouTube search you agree to the [YouTube Terms of Service](https://www.youtube.com/t/terms).\n"})})},Ct=function(){return Object($.jsx)("div",{style:Ot,children:Object($.jsx)(xt.a,{children:"\nFAQ\n====\nWhat's a VBrowser?\n----\nA virtual browser (VBrowser) is a browser running in the cloud that a room's members can connect to. Everyone in the room sees the same thing, so it's a great way to watch videos or collaborate on tasks together.\n\nWhy did my VBrowser session stop?\n----\nVBrowsers will terminate automatically if no one is in the room for a while.\nVBrowser sessions are also limited to a maximum of 3 hours for free users, and 24 hours for subscribers.\n\nDoes everyone in the room need to be a subscriber to get the benefits?\n----\nNo, only the person who created the VBrowser needs to be.\n\nHow do I access sites that have a \"not available\" message in the VBrowser?\n----\nSome sites may block traffic that's detected as coming from certain geographic regions. You may need to install an extension like Hola VPN inside the virtual browser.\n\nHow come I'm not getting any audio when screensharing?\n----\nTo share audio, you must be using Chrome or Edge, sharing a tab (not application), and check a small checkbox at the bottom-left of the share screen dialog.\n\nIs there a limit to how many people can be in a room?\n----\nCurrently there isn't a hard limit, although the service hasn't been tested with more than 15 people or so. Screensharing and filesharing rely on one person uploading to everyone else, so it may not work well with large room sizes.\n"})})},Tt=function(){return Object($.jsxs)("div",{style:{margin:"1em",fontSize:"14px",color:"white"},children:[Object($.jsx)(m.b,{style:{color:"white"},to:"/terms",children:"Terms"})," \xb7 ",Object($.jsx)(m.b,{style:{color:"white"},to:"/privacy",children:"Privacy"})," \xb7 ",Object($.jsx)(m.b,{style:{color:"white"},to:"/faq",children:"FAQ"})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(371);var Mt=Object(u.lazy)((function(){return Promise.all([n.e(3),n.e(4)]).then(n.bind(null,692))})),Pt='{"apiKey":"AIzaSyA2fkXeFokJ-Ei_jnzDso5AmjbIaMdzuEc","authDomain":"watchparty-273604.firebaseapp.com","databaseURL":"https://watchparty-273604.firebaseio.com","projectId":"watchparty-273604","storageBucket":"watchparty-273604.appspot.com","messagingSenderId":"769614672795","appId":"1:769614672795:web:54bbda86288ab1a034273e"}';ne.a.initializeApp(JSON.parse(Pt));var Rt=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={user:void 0,isSubscriber:!1,isCustomer:!1},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=Object(r.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ne.a.auth().onAuthStateChanged(function(){var e=Object(r.a)(i.a.mark((function e(n){var a,r,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=12;break}return t.setState({user:n}),e.next=4,n.getIdToken();case 4:return a=e.sent,e.next=7,window.fetch(z.s+"/metadata?uid=".concat(n.uid,"&token=").concat(a));case 7:return r=e.sent,e.next=10,r.json();case 10:s=e.sent,t.setState({isSubscriber:s.isSubscriber,isCustomer:s.isCustomer});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object($.jsx)(d.a.StrictMode,{children:Object($.jsxs)(m.a,{children:[Object($.jsx)(b.a,{path:"/",exact:!0,render:function(t){var n;return(null===(n=t.location)||void 0===n?void 0:n.hash)?Object($.jsx)(mt,{user:e.state.user,isSubscriber:e.state.isSubscriber,isCustomer:e.state.isCustomer}):Object($.jsxs)(d.a.Fragment,{children:[Object($.jsx)(be,{user:e.state.user,isSubscriber:e.state.isSubscriber,isCustomer:e.state.isCustomer,hideNewRoom:!0}),Object($.jsx)(vt,{user:e.state.user}),Object($.jsx)(Tt,{})]})}}),Object($.jsx)(b.a,{path:"/r/:vanity",exact:!0,render:function(t){return Object($.jsx)(mt,{user:e.state.user,isSubscriber:e.state.isSubscriber,isCustomer:e.state.isCustomer,vanity:t.match.params.vanity})}}),Object($.jsxs)(b.a,{path:"/terms",children:[Object($.jsx)(be,{user:this.state.user,isSubscriber:this.state.isSubscriber,isCustomer:this.state.isCustomer}),Object($.jsx)(St,{}),Object($.jsx)(Tt,{})]}),Object($.jsxs)(b.a,{path:"/privacy",children:[Object($.jsx)(be,{user:this.state.user,isSubscriber:this.state.isSubscriber,isCustomer:this.state.isCustomer}),Object($.jsx)(kt,{}),Object($.jsx)(Tt,{})]}),Object($.jsxs)(b.a,{path:"/faq",children:[Object($.jsx)(be,{user:this.state.user,isSubscriber:this.state.isSubscriber,isCustomer:this.state.isCustomer}),Object($.jsx)(Ct,{}),Object($.jsx)(Tt,{})]}),Object($.jsxs)(b.a,{path:"/debug",children:[Object($.jsx)(be,{user:this.state.user,isSubscriber:this.state.isSubscriber,isCustomer:this.state.isCustomer}),Object($.jsx)(u.Suspense,{fallback:null,children:Object($.jsx)(Mt,{})}),Object($.jsx)(Tt,{})]})]})})}}]),n}(d.a.Component);p.a.render(Object($.jsx)(Rt,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},62:function(e,t,n){e.exports={container:"Home_container__1ukFy",hero:"Home_hero__1zBE5",green:"Home_green__3PMJt",heroInner:"Home_heroInner__3w7l9",heroText:"Home_heroText__21xIv",subText:"Home_subText__363Kx",featureSection:"Home_featureSection__1E5B_",featureTitle:"Home_featureTitle__37GMX",featureText:"Home_featureText__2VOwD"}},73:function(e,t,n){e.exports={Card:"ChatVideoCard_Card__38w-I",Wrapper:"ChatVideoCard_Wrapper__3cH2f",ThumbnailWrapper:"ChatVideoCard_ThumbnailWrapper__hBV8X",Thumbnail:"ChatVideoCard_Thumbnail__1J61h",Content:"ChatVideoCard_Content__1q2Wx",Title:"ChatVideoCard_Title__2XtVu",ChannelName:"ChatVideoCard_ChannelName__3RX-r",DurationLabel:"ChatVideoCard_DurationLabel__2dPHz",Controls:"ChatVideoCard_Controls__3AJAK"}}},[[370,1,2]]]);
//# sourceMappingURL=main.17ad14d3.chunk.js.map